/**
 * @class The built-in Array class.
 * @name Array
 *//**
 * Creates a new array with the results of calling a provided function on every
 * element in this array. Implemented in Javascript 1.6.
 *
 * @function
 * @name Array.prototype.map
 * @see <a
 * href="https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Objects/Array/Map">map</a>
 * documentation.
 * @param {function} f function that produces an element of the new Array from
 * an element of the current one.
 * @param [o] object to use as <tt>this</tt> when executing <tt>f</tt>.
 */Array.prototype.map||(Array.prototype.map=function(a,b){var c=this.length,d=Array(c);for(var e=0;e<c;e++)e in this&&(d[e]=a.call(b,this[e],e,this));return d}),Array.prototype.filter||(Array.prototype.filter=function(a,b){var c=this.length,d=[];for(var e=0;e<c;e++)if(e in this){var f=this[e];a.call(b,f,e,this)&&d.push(f)}return d}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c=this.length>>>0;for(var d=0;d<c;d++)d in this&&a.call(b,this[d],d,this)}),Array.prototype.reduce||(Array.prototype.reduce=function(a,b){var c=this.length;if(!c&&arguments.length==1)throw new Error("reduce: empty array, no initial value");var d=0;if(arguments.length<2)for(;;){if(d in this){b=this[d++];break}if(++d>=c)throw new Error("reduce: no values, no initial value")}for(;d<c;d++)d in this&&(b=a(b,this[d],d,this));return b}),Array.isArray||(Array.isArray=function(a){return Object.prototype.toString.call(a)=="[object Array]"});var pv={};pv.version={major:3,minor:3},pv.identity=function(a){return a},pv.index=function(){return this.index},pv.child=function(){return this.childIndex},pv.parent=function(){return this.parent.index},pv._=function(a){return a},pv.extend=Object.create?function(a){return Object.create(a.prototype||a)}:function(a){function b(){}return b.prototype=a.prototype||a,new b};try{eval("pv.parse = function(x) x;")}catch(e){pv.parse=function(a){var b=new RegExp("function\\s*(\\b\\w+)?\\s*\\([^)]*\\)\\s*","mg"),c,d,e=0,f="";while(c=b.exec(a)){var g=c.index+c[0].length;if(a.charAt(g)!="{"){f+=a.substring(e,g)+"{return ",e=g;for(var h=0;h>=0&&g<a.length;g++){var i=a.charAt(g);switch(i){case'"':case"'":while(++g<a.length&&(d=a.charAt(g))!=i)d=="\\"&&g++;break;case"[":case"(":h++;break;case"]":case")":h--;break;case";":case",":h===0&&h--}}f+=pv.parse(a.substring(e,--g))+";}",e=g}b.lastIndex=g}return f+=a.substring(e),f}}pv.css=function(a,b){return window.getComputedStyle?window.getComputedStyle(a,null).getPropertyValue(b):a.currentStyle[b]},pv.error=function(a,b){typeof console=="undefined"?!b&&alert(a):console.error(a)},pv.listen=function(a,b,c){return c=pv.listener(c),a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},pv.listener=function(a){return a.$listener||(a.$listener=function(b){try{return pv.event=b,a.call(this,b)}finally{delete pv.event}})},pv.ancestor=function(a,b){while(b){if(b==a)return!0;b=b.parentNode}return!1},pv.id=function(){var a=1;return function(){return a++}}(),pv.functor=function(a){return typeof a=="function"?a:function(){return a}},pv.listen(window,"load",function(){pv.$={i:0,x:document.getElementsByTagName("script")};for(;pv.$.i<pv.$.x.length;pv.$.i++){pv.$.s=pv.$.x[pv.$.i];if(pv.$.s.type=="text/javascript+protovis")try{window.eval(pv.parse(pv.$.s.text))}finally{}}delete pv.$}),pv.Format={},pv.Format.re=function(a){return a.replace(/[\\\^\$\*\+\?\[\]\(\)\.\{\}]/g,"\\$&")},pv.Format.re.compile=function(a,b){var c=a+"/"+b;return pv.Format.re.$cache[c]||(pv.Format.re.$cache[c]=new RegExp(a,b||"")),pv.Format.re.$cache[c]},pv.Format.re.$cache={},pv.Format.pad=function(a,b,c){var d=b-String(c).length;return d<1?c:Array(d+1).join(a)+c},pv.Format.date=function(a,b){function d(e){return isNaN(e)?"â˜¹":a.replace(/%[a-zA-Z0-9]/g,function(a){switch(a){case"%a":return pv._(d.days[e.getUTCDay()].substring(0,3),b);case"%A":return pv._(d.days[e.getUTCDay()],b);case"%h":case"%b":return pv._(d.months[e.getUTCMonth()].substring(0,3),b);case"%B":return pv._(d.months[e.getUTCMonth()],b);case"%c":return e.toLocaleString();case"%C":return c("0",2,Math.floor(e.getUTCFullYear()/100)%100);case"%d":return c("0",2,e.getUTCDate());case"%f":case"%Q":return c("0",3,e.getUTCMilliseconds());case"%e":return c(" ",2,e.getUTCDate());case"%g":return c("0",2,d.isocalendar(e)[0]%100);case"%G":return c("0",4,d.isocalendar(e)[0]);case"%H":return c("0",2,e.getUTCHours());case"%I":return c("0",2,e.getUTCHours()%12||12);case"%j":return c("0",3,Math.floor((e-Date.UTC(e.getUTCFullYear(),0,1))/864e5)+1);case"%k":return e.getUTCHours();case"%l":return e.getUTCHours()%12||12;case"%m":return c("0",2,e.getUTCMonth()+1);case"%M":return c("0",2,e.getUTCMinutes());case"%n":return"\n";case"%p":return e.getUTCHours()<12?"AM":"PM";case"%P":return e.getUTCHours()<12?"am":"pm";case"%q":return Math.floor(e.getUTCMonth()/3)+1;case"%s":return~~(e/1e3);case"%S":return c("0",2,e.getUTCSeconds());case"%t":return"\t";case"%u":return e.getUTCDay()||7;case"%U":var f=Math.floor((e-Date.UTC(e.getUTCFullYear(),0,1))/864e5)+1;return c("0",2,Math.floor((f+6-e.getUTCDay())/7));case"%V":return c("0",2,d.isocalendar(e)[1]);case"%w":return e.getUTCDay();case"%W":var f=Math.floor((e-Date.UTC(e.getUTCFullYear(),0,1))/864e5)+1;return c("0",2,Math.floor((f+7-(e.getUTCDay()||7))/7));case"%y":return c("0",2,e.getUTCFullYear()%100);case"%Y":return e.getUTCFullYear();case"%z":return"+0000";case"%Z":return"UTC";case"%%":return"%"}return a})}var c=pv.Format.pad;a=a.replace(/%F/g,"%Y-%m-%d").replace(/%[Dx]/g,"%m/%d/%y").replace(/%[Xr]/g,"%I:%M:%S %p").replace(/%R/g,"%H:%M").replace(/%T/g,"%H:%M:%S"),d.format=d;var e=[function(){}],f=pv.Format.re(a).replace(/(%[a-zA-Z0-9]|\s+)/g,function(a){if(/^\s/.test(a))return"\\s+";switch(a){case"%A":case"%a":return e.push(function(){}),"([A-Za-z]+)";case"%b":case"%h":case"%B":return e.push(function(a,b){a=a.toLowerCase();var c=-1,d=this.months,e=a.length;while(++c<12)if(d[c].substr(0,e).toLowerCase()==a)return b.month=c}),"([A-Za-z]+)";case"%C":return e.push(function(a,b){b.year=a*100+b.year%100}),"(\\d\\d)";case"%e":return e.push(function(a,b){b.date=Number(a)}),"\\s?([12]\\d|3[01]|[1-9])";case"%d":return e.push(function(a,b){b.date=Number(a)}),"\\s?(0[1-9]|[12]\\d|3[01])";case"%f":case"%Q":return e.push(function(a,b){b.msec=parseFloat("0."+a)*1e3}),"(\\d{3,6})";case"%g":return e.push(function(a,b){a=Number(a),b.isoyear=a+(a<69?2e3:1900)}),"(\\d\\d)";case"%G":return e.push(function(a,b){b.isoyear=Number(a)}),"(\\d{4})";case"%I":return e.push(function(a,b){b.hour=Number(a)}),"(0\\d|[12]\\d|[1-9])";case"%H":return e.push(function(a,b){b.hour=Number(a)}),"(0\\d|1\\d|2[0-4]|[1-9])";case"%j":return e.push(function(a,b){b.month=0,b.date=Number(a)}),"(\\d{3})";case"%l":return e.push(function(a,b){b.hour=Number(a)}),"\\s?(\\d|1[012])";case"%m":return e.push(function(a,b){b.month=Number(a)-1}),"(0[1-9]|1[012]|[1-9])";case"%M":return e.push(function(a,b){b.minute=Number(a)}),"(0\\d|[1-5]\\d)";case"%p":case"%P":return e.push(function(a,b){b.hour=b.hour%12+(/^a\.?m$/i.test(a)?0:12)}),"([ap]\\.?m|[AP]\\.?M)\\.?";case"%q":return e.push(function(a,b){b.date=1,b.month=(Number(a)-1)*3}),"(\\d)";case"%s":return e.push(function(a,b){b.ts=a*1e3}),"(-?\\d+)";case"%S":return e.push(function(a,b){b.second=Number(a)}),"(0\\d|[1-5]\\d|6[01])";case"%n":case"%t":return"\\s*";case"%U":return e.push(function(){}),"(0\\d|[1-4]\\d|5[0-3]|[1-9])";case"%u":return e.push(function(a,b){b.isoday=Number(a)}),"([1-7])";case"%V":return e.push(function(a,b){b.isoweek=Number(a)}),"(0[1-9]|[1-4]\\d|5[0-3])";case"%w":return e.push(function(){}),"([0-6])";case"%W":return e.push(function(){}),"(0\\d|[1-4]\\d|5[0-3]|[1-9])";case"%y":return e.push(function(a,b){a=Number(a),b.year=a+(a<69?2e3:1900)}),"(\\d\\d)";case"%Y":return e.push(function(a,b){b.year=Number(a)}),"([+\\-]?\\d{4})";case"%z":case"%Z":return e.push(function(){}),"([+-]\\d{4}|GMT|[CEP]ST|UTC|Z)";case"%%":return"%"}return a});return d.parse=function(a){var b=a.match(f);if(b){var c={msec:0,second:0,minute:0,hour:0,date:1,month:0,year:1970,isoyear:null,isoweek:null,isoday:null,ts:null};b.forEach(function(a,b){e[b].call(d,a,c)});if(c.ts!==null)return new Date(c.ts);if(c.isoyear!==null&&c.isoweek!==null){var g=new Date(Date.UTC(c.isoyear,0,3));c.year=c.isoyear,c.month=0,c.date=3-g.getUTCDay()+(c.isoweek-1)*7+(c.isoday||1)}var h=new Date(Date.UTC(c.year,c.month,c.date,c.hour,c.minute,c.second,c.msec));return c.year<100&&c.year>=0&&h.setUTCFullYear(c.year),h}return new Date("?")},d.months=["January","February","March","April","May","June","July","August","September","October","November","December"],d.days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d.isocalendar=function(a){var b=a.getUTCDay(),c=new Date(a*1);c.setDate(c.getDate()-(b+6)%7+3);var d=c.getUTCFullYear(),e=Math.floor((c.getTime()-Date.UTC(d,0,1,-6))/864e5);return[d,1+Math.floor(e/7),b||7]},d},pv.Format.time=function(a,b){function d(d){d=Number(d);switch(a){case"short":if(d>=31536e6)return(d/31536e6).toFixed(1)+" "+pv._("years",b);if(d>=6048e5)return(d/6048e5).toFixed(1)+" "+pv._("weeks",b);if(d>=864e5)return(d/864e5).toFixed(1)+" "+pv._("days",b);if(d>=36e5)return(d/36e5).toFixed(1)+" "+pv._("hours",b);if(d>=6e4)return(d/6e4).toFixed(1)+" "+pv._("minutes",b);return(d/1e3).toFixed(1)+" "+pv._("seconds",b);case"long":var e=[],f=d%6e4/1e3>>0,g=d%36e5/6e4>>0;e.push(c("0",2,f));if(d>=36e5){var h=d%864e5/36e5>>0;e.push(c("0",2,g)),d>=864e5?(e.push(c("0",2,h)),e.push(Math.floor(d/864e5).toFixed())):e.push(h.toFixed())}else e.push(g.toFixed());return e.reverse().join(":")}}var c=pv.Format.pad;return d.format=d,d.parse=function(b){var c,d=0;switch(a){case"short":var e=/([0-9,.]+)\s*([a-z]+)/g;while(c=e.exec(b)){var f=parseFloat(c[0].replace(",","")),g=0;switch(c[2].toLowerCase()){case"year":case"years":g=31536e6;break;case"week":case"weeks":g=6048e5;break;case"day":case"days":g=864e5;break;case"hour":case"hours":g=36e5;break;case"minute":case"minutes":g=6e4;break;case"second":case"seconds":g=1e3}d+=f*g}return d;case"long":return c=b.replace(",","").split(":").reverse(),c.length&&(d+=parseFloat(c[0])*1e3),c.length>1&&(d+=parseFloat(c[1])*6e4),c.length>2&&(d+=parseFloat(c[2])*36e5),c.length>3&&(d+=parseFloat(c[3])*864e5),d}},d},pv.Format.number=function(){function q(g){Infinity>e&&(g=g<0&&p?-Math.round(-g*f)/f:Math.round(g*f)/f);var i=g<0,q="",r="",s="",t=String(Math.abs(g)).split("."),u=t[0].length,v=Math.floor(Math.abs(g));u>b&&(v=Number(t[0].substring(u-b)),u=b),k&&u<a&&(q=h.substring(0,a-u));var w,x="";do w=v%1e3,v=Math.floor(v/1e3),x=(v?m:"")+(w<100&&v?"0":"")+(w<10&&v?"0":"")+(w+x),v&&++u;while(v);return!k&&u<c&&(q=h.substring(0,c-u)),g%1&&(r=l,s=t[1]+j.substring(0,d-t[1].length)),i?n+q+x+r+s+o:q+x+r+s}var a=0,b=Infinity,c=0,d=0,e=0,f=1,g="0",h="",i="0",j="",k=!0,l=".",m=",",n="âˆ’",o="",p=!0;return q.format=q,q.parse=function(a){var c=pv.Format.re;compile=c.compile;var d=String(a).replace(compile("^(?:"+c(g)+")*"),"").replace(compile("(?:"+c(i)+")*$"),"").split(l),h=d[0].replace(compile(c(m),"g"),"");h.length>b&&(h=h.substring(h.length-b));var j=d[1]?Number("0."+d[1]):0;return Infinity>e&&(j=Math.round(j*f)/f),Math.round(h)+j},q.integerDigits=function(d,e){return arguments.length?(a=Number(d),b=arguments.length>1?Number(e):a,c=a+Math.floor(a/3)*m.length,h=pv.Format.pad(g,a,""),this):[a,b]},q.fractionDigits=function(a,b){return arguments.length?(d=Number(a),e=arguments.length>1?Number(b):d,f=Math.pow(10,e),j=pv.Format.pad(i,d,""),this):[d,e]},q.integerPad=function(b){return arguments.length?(g=String(b),h=pv.Format.pad(g,a,""),k=/\d/.test(g),this):g},q.fractionPad=function(a){return arguments.length?(i=String(a),j=pv.Format.pad(i,d,""),this):i},q.decimal=function(a){return arguments.length?(l=String(a),this):l},q.group=function(b){return arguments.length?(m=b?String(b):"",c=a+Math.floor(a/3)*m.length,this):m},q.symmetricRounding=function(a){return arguments.length?(p=!!a,this):!!a},q.negativeAffix=function(a,b){return arguments.length?(n=String(a||""),o=String(b||""),this):[n,o]},q},pv.map=function(a,b){var c={};return b?a.map(function(a,d){return c.index=d,b.call(c,a)}):a.slice()},pv.repeat=function(a,b){return arguments.length==1&&(b=2),pv.blend(pv.range(b).map(function(){return a}))},pv.cross=function(a,b){var c=[];for(var d=0,e=a.length,f=b.length;d<e;d++)for(var g=0,h=a[d];g<f;g++)c.push([h,b[g]]);return c},pv.blend=function(a){return Array.prototype.concat.apply([],a)},pv.transpose=function(a){var b=a.length,c=pv.max(a,function(a){return a.length});if(c>b){a.length=c;for(var d=b;d<c;d++)a[d]=Array(b);for(var d=0;d<b;d++)for(var e=d+1;e<c;e++){var f=a[d][e];a[d][e]=a[e][d],a[e][d]=f}}else{for(var d=0;d<c;d++)a[d].length=b;for(var d=0;d<b;d++)for(var e=0;e<d;e++){var f=a[d][e];a[d][e]=a[e][d],a[e][d]=f}}a.length=c;for(var d=0;d<c;d++)a[d].length=b;return a},pv.normalize=function(a,b){var c=pv.map(a,b),d=pv.sum(c);for(var e=0;e<c.length;e++)c[e]/=d;return c},pv.permute=function(a,b,c){c||(c=pv.identity);var d=Array(b.length),e={};return b.forEach(function(b,g){e.index=b,d[g]=c.call(e,a[b])}),d},pv.numerate=function(a,b){b||(b=pv.identity);var c={},d={};return a.forEach(function(a,e){d.index=e,c[b.call(d,a)]=e}),c},pv.uniq=function(a,b){b||(b=pv.identity);var c={},d=[],e={},f;return a.forEach(function(a,g){e.index=g,f=b.call(e,a),f in c||(c[f]=d.push(f))}),d},pv.naturalOrder=function(a,b){return a<b?-1:a>b?1:0},pv.reverseOrder=function(a,b){return b<a?-1:b>a?1:0},pv.search=function(a,b,c){c||(c=pv.identity);var d=0,e=a.length-1;while(d<=e){var f=d+e>>1,g=c(a[f]);if(g<b)d=f+1;else if(g>b)e=f-1;else return f}return-d-1},pv.search.index=function(a,b,c){var d=pv.search(a,b,c);return d<0?-d-1:d},pv.range=function(a,b,c){arguments.length==1&&(b=a,a=0),c==null&&(c=1);if((b-a)/c==Infinity)throw new Error("range must be finite");var d=[],e=0,f;b-=(b-a)*1e-10;if(c<0)while((f=a+c*e++)>b)d.push(f);else while((f=a+c*e++)<b)d.push(f);return d},pv.random=function(a,b,c){return arguments.length==1&&(b=a,a=0),c==null&&(c=1),c?Math.floor(Math.random()*(b-a)/c)*c+a:Math.random()*(b-a)+a},pv.sum=function(a,b){var c={};return a.reduce(b?function(a,d,e){return c.index=e,a+b.call(c,d)}:function(a,b){return a+b},0)},pv.max=function(a,b){return b==pv.index?a.length-1:Math.max.apply(null,b?pv.map(a,b):a)},pv.max.index=function(a,b){if(!a.length)return-1;if(b==pv.index)return a.length-1;b||(b=pv.identity);var c=0,d=-Infinity,e={};for(var f=0;f<a.length;f++){e.index=f;var g=b.call(e,a[f]);g>d&&(d=g,c=f)}return c},pv.min=function(a,b){return b==pv.index?0:Math.min.apply(null,b?pv.map(a,b):a)},pv.min.index=function(a,b){if(!a.length)return-1;if(b==pv.index)return 0;b||(b=pv.identity);var c=0,d=Infinity,e={};for(var f=0;f<a.length;f++){e.index=f;var g=b.call(e,a[f]);g<d&&(d=g,c=f)}return c},pv.mean=function(a,b){return pv.sum(a,b)/a.length},pv.median=function(a,b){if(b==pv.index)return(a.length-1)/2;a=pv.map(a,b).sort(pv.naturalOrder);if(a.length%2)return a[Math.floor(a.length/2)];var c=a.length/2;return(a[c-1]+a[c])/2},pv.variance=function(a,b){if(a.length<1)return NaN;if(a.length==1)return 0;var c=pv.mean(a,b),d=0,e={};b||(b=pv.identity);for(var f=0;f<a.length;f++){e.index=f;var g=b.call(e,a[f])-c;d+=g*g}return d},pv.deviation=function(a,b){return Math.sqrt(pv.variance(a,b)/(a.length-1))},pv.log=function(a,b){return Math.log(a)/Math.log(b)},pv.logSymmetric=function(a,b){return a===0?0:a<0?-pv.log(-a,b):pv.log(a,b)},pv.logAdjusted=function(a,b){if(!isFinite(a))return a;var c=a<0;return a<b&&(a+=(b-a)/b),c?-pv.log(a,b):pv.log(a,b)},pv.logFloor=function(a,b){return a>0?Math.pow(b,Math.floor(pv.log(a,b))):-Math.pow(b,-Math.floor(-pv.log(-a,b)))},pv.logCeil=function(a,b){return a>0?Math.pow(b,Math.ceil(pv.log(a,b))):-Math.pow(b,-Math.ceil(-pv.log(-a,b)))},function(){var a=Math.PI/180,b=180/Math.PI;pv.radians=function(b){return a*b},pv.degrees=function(a){return b*a}}(),pv.keys=function(a){var b=[];for(var c in a)b.push(c);return b},pv.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},pv.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},pv.dict=function(a,b){var c={},d={};for(var e=0;e<a.length;e++)if(e in a){var f=a[e];d.index=e,c[f]=b.call(d,f)}return c},pv.dom=function(a){return new pv.Dom(a)},pv.Dom=function(a){this.$map=a},pv.Dom.prototype.$leaf=function(a){return typeof a!="object"},pv.Dom.prototype.leaf=function(a){return arguments.length?(this.$leaf=a,this):this.$leaf},pv.Dom.prototype.root=function(a){function d(a){var c=new pv.Dom.Node;for(var e in a){var f=a[e];c.appendChild(b(f)?new pv.Dom.Node(f):d(f)).nodeName=e}return c}var b=this.$leaf,c=d(this.$map);return c.nodeName=a,c},pv.Dom.prototype.nodes=function(){return this.root().nodes()},pv.Dom.Node=function(a){this.nodeValue=a,this.childNodes=[]},pv.Dom.Node.prototype.parentNode=null,pv.Dom.Node.prototype.firstChild=null,pv.Dom.Node.prototype.lastChild=null,pv.Dom.Node.prototype.previousSibling=null,pv.Dom.Node.prototype.nextSibling=null,pv.Dom.Node.prototype.removeChild=function(a){var b=this.childNodes.indexOf(a);if(b==-1)throw new Error("child not found");return this.childNodes.splice(b,1),a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling,a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling,delete a.nextSibling,delete a.previousSibling,delete a.parentNode,a},pv.Dom.Node.prototype.appendChild=function(a){return a.parentNode&&a.parentNode.removeChild(a),a.parentNode=this,a.previousSibling=this.lastChild,this.lastChild?this.lastChild.nextSibling=a:this.firstChild=a,this.lastChild=a,this.childNodes.push(a),a},pv.Dom.Node.prototype.insertBefore=function(a,b){if(!b)return this.appendChild(a);var c=this.childNodes.indexOf(b);if(c==-1)throw new Error("child not found");return a.parentNode&&a.parentNode.removeChild(a),a.parentNode=this,a.nextSibling=b,a.previousSibling=b.previousSibling,b.previousSibling?b.previousSibling.nextSibling=a:(b==this.lastChild&&(this.lastChild=a),this.firstChild=a),this.childNodes.splice(c,0,a),a},pv.Dom.Node.prototype.replaceChild=function(a,b){var c=this.childNodes.indexOf(b);if(c==-1)throw new Error("child not found");return a.parentNode&&a.parentNode.removeChild(a),a.parentNode=this,a.nextSibling=b.nextSibling,a.previousSibling=b.previousSibling,b.previousSibling?b.previousSibling.nextSibling=a:this.firstChild=a,b.nextSibling?b.nextSibling.previousSibling=a:this.lastChild=a,this.childNodes[c]=a,b},pv.Dom.Node.prototype.visitBefore=function(a){function b(c,d){a(c,d);for(var e=c.firstChild;e;e=e.nextSibling)b(e,d+1)}b(this,0)},pv.Dom.Node.prototype.visitAfter=function(a){function b(c,d){for(var e=c.firstChild;e;e=e.nextSibling)b(e,d+1);a(c,d)}b(this,0)},pv.Dom.Node.prototype.sort=function(a){if(this.firstChild){this.childNodes.sort(a);var b=this.firstChild=this.childNodes[0],c;delete b.previousSibling;for(var d=1;d<this.childNodes.length;d++)b.sort(a),c=this.childNodes[d],c.previousSibling=b,b=b.nextSibling=c;this.lastChild=b,delete b.nextSibling,b.sort(a)}return this},pv.Dom.Node.prototype.reverse=function(){var a=[];return this.visitAfter(function(b){while(b.lastChild)a.push(b.removeChild(b.lastChild));for(var c=0,d=a.length;c<d;c++)b.insertBefore(a[c],b.firstChild)}),this},pv.Dom.Node.prototype.nodes=function(){function b(c){a.push(c),c.childNodes.forEach(b)}var a=[];return b(this,a),a},pv.Dom.Node.prototype.toggle=function(a){var b=this;if(a)return this.toggled?this.visitBefore(function(a){a.toggled&&a.toggle()}):this.visitAfter(function(a){a.toggled||a.toggle()});if(b.toggled){for(var c=0,d=b.toggled.length;c<d;c++)b.appendChild(b.toggled[c]);delete b.toggled}else if(b.lastChild){b.toggled=[];while(b.lastChild)b.toggled.push(b.removeChild(b.lastChild))}},pv.nodes=function(a){var b=new pv.Dom.Node;for(var c=0;c<a.length;c++)b.appendChild(new pv.Dom.Node(a[c]));return b.nodes()},pv.tree=function(a){return new pv.Tree(a)},pv.Tree=function(a){this.array=a},pv.Tree.prototype.keys=function(a){return this.k=a,this},pv.Tree.prototype.value=function(a){return this.v=a,this},pv.Tree.prototype.map=function(){var a={},b={};for(var c=0;c<this.array.length;c++){b.index=c;var d=this.array[c],e=this.k.call(b,d),f=a;for(var g=0;g<e.length-1;g++)f=f[e[g]]||(f[e[g]]={});f[e[g]]=this.v?this.v.call(b,d):d}return a},pv.nest=function(a){return new pv.Nest(a)},pv.Nest=function(a){this.array=a,this.keys=[]},pv.Nest.prototype.key=function(a){return this.keys.push(a),this},pv.Nest.prototype.sortKeys=function(a){return this.keys[this.keys.length-1].order=a||pv.naturalOrder,this},pv.Nest.prototype.sortValues=function(a){return this.order=a||pv.naturalOrder,this},pv.Nest.prototype.map=function(){var a={},b=[];for(var c,d,e=0;e<this.array.length;e++){var f=this.array[e],g=a;for(d=0;d<this.keys.length-1;d++)c=this.keys[d](f),g[c]||(g[c]={}),g=g[c];c=this.keys[d](f);if(!g[c]){var h=[];b.push(h),g[c]=h}g[c].push(f)}if(this.order)for(var d=0;d<b.length;d++)b[d].sort(this.order);return a},pv.Nest.prototype.entries=function(){function a(b){var c=[];for(var d in b){var e=b[d];c.push({key:d,values:Array.isArray(e)?e:a(e)})}return c}function b(a,c){var d=this.keys[c].order;d&&a.sort(function(a,b){return d(a.key,b.key)});if(++c<this.keys.length)for(var e=0;e<a.length;e++)b.call(this,a[e].values,c);return a}return b.call(this,a(this.map()),0)},pv.Nest.prototype.rollup=function(a){function b(c){for(var d in c){var e=c[d];Array.isArray(e)?c[d]=a(e):b(e)}return c}return b(this.map())},pv.flatten=function(a){return new pv.Flatten(a)},pv.Flatten=function(a){this.map=a,this.keys=[]},pv.Flatten.prototype.key=function(a,b){return this.keys.push({name:a,value:b}),delete this.$leaf,this},pv.Flatten.prototype.leaf=function(a){return this.keys.length=0,this.$leaf=a,this},pv.Flatten.prototype.array=function(){function f(d,e){if(e<c.length-1)for(var g in d)b.push(g),f(d[g],e+1),b.pop();else a.push(b.concat(d))}var a=[],b=[],c=this.keys,d=this.$leaf;if(d){var e=function(c,f){if(d(c))a.push({keys:b.slice(),value:c});else for(var g in c)b.push(g),e(c[g],f+1),b.pop()};return e(this.map,0),a}return f(this.map,0),a.map(function(a){var b={};for(var d=0;d<c.length;d++){var e=c[d],f=a[d];b[e.name]=e.value?e.value.call(null,f):f}return b})},pv.vector=function(a,b){return new pv.Vector(a,b)},pv.Vector=function(a,b){this.x=a,this.y=b},pv.Vector.prototype.perp=function(){return new pv.Vector(-this.y,this.x)},pv.Vector.prototype.norm=function(){var a=this.length();return this.times(a?1/a:1)},pv.Vector.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},pv.Vector.prototype.times=function(a){return new pv.Vector(this.x*a,this.y*a)},pv.Vector.prototype.plus=function(a,b){return arguments.length==1?new pv.Vector(this.x+a.x,this.y+a.y):new pv.Vector(this.x+a,this.y+b)},pv.Vector.prototype.minus=function(a,b){return arguments.length==1?new pv.Vector(this.x-a.x,this.y-a.y):new pv.Vector(this.x-a,this.y-b)},pv.Vector.prototype.dot=function(a,b){return arguments.length==1?this.x*a.x+this.y*a.y:this.x*a+this.y*b},pv.Transform=function(){},pv.Transform.prototype={k:1,x:0,y:0},pv.Transform.identity=new pv.Transform,pv.Transform.prototype.translate=function(a,b){var c=new pv.Transform;return c.k=this.k,c.x=this.k*a+this.x,c.y=this.k*b+this.y,c},pv.Transform.prototype.scale=function(a){var b=new pv.Transform;return b.k=this.k*a,b.x=this.x,b.y=this.y,b},pv.Transform.prototype.invert=function(){var a=new pv.Transform,b=1/this.k;return a.k=b,a.x=-this.x*b,a.y=-this.y*b,a},pv.Transform.prototype.times=function(a){var b=new pv.Transform;return b.k=this.k*a.k,b.x=this.k*a.x+this.x,b.y=this.k*a.y+this.y,b},pv.Scale=function(){},pv.Scale.interpolator=function(a,b){return typeof a=="number"?(b=b||0,function(c){return c*(b-a)+a}):(a=pv.color(a==null?"rgba(0,0,0,0)":a).rgb(),b=pv.color(b==null?"rgba(0,0,0,0)":b).rgb(),function(c){var d=a.a*(1-c)+b.a*c;return d<1e-5&&(d=0),a.a===0?pv.rgb(b.r,b.g,b.b,d):b.a===0?pv.rgb(a.r,a.g,a.b,d):pv.rgb(Math.round(a.r*(1-c)+b.r*c),Math.round(a.g*(1-c)+b.g*c),Math.round(a.b*(1-c)+b.b*c),d)})},pv.Scale.quantitative=function(){function j(a){return new Date(a)}function k(c){var e=pv.search(a,c);e<0&&(e=-e-2),e=Math.max(0,Math.min(d.length-1,e));var f=g(c)-b[e],h=b[e+1]-b[e];return h?d[e](f/h):d[e](f)}var a=[0,1],b=[0,1],c=[0,1],d=[pv.identity],e=Number,f=!1,g=pv.identity,h=pv.identity,i=String;return k.transform=function(c,d){return g=function(a){return f?-c(-a):c(a)},h=function(a){return f?-d(-a):d(a)},b=a.map(g),this},k.domain=function(c,d,h){if(arguments.length){var i;return Array.isArray(c)?(arguments.length<2&&(d=pv.identity),arguments.length<3&&(h=d),i=c.length&&d(c[0]),a=c.length?[pv.min(c,d),pv.max(c,h)]:[]):(i=c,a=Array.prototype.slice.call(arguments).map(Number)),a.length?a.length==1&&(a=[a[0],a[0]]):a=[-Infinity,Infinity],f=(a[0]||a[a.length-1])<0,b=a.map(g),e=Object.prototype.toString.call(i)==="[object Date]"?j:Number,this}return a.map(e)},k.range=function(){if(arguments.length){c=Array.prototype.slice.call(arguments),c.length?c.length==1&&(c=[c[0],c[0]]):c=[-Infinity,Infinity],d=[];for(var a=0;a<c.length-1;a++)d.push(pv.Scale.interpolator(c[a],c[a+1]));return this}return c},k.invert=function(a){var f=pv.search(c,a);return f<0&&(f=-f-2),f=Math.max(0,Math.min(d.length-1,f)),e(h(b[f]+(a-c[f])/(c[f+1]-c[f])*(b[f+1]-b[f])))},k.ticks=function(b){var c=a[0],d=a[a.length-1],f=d<c,g=f?d:c,h=f?c:d,k=h-g;if(!k||!isFinite(k))return e==j&&(i=pv.Format.date("%x")),[e(g)];if(e==j){var l=function(a,b){switch(b){case 31536e6:a.setMonth(0);case 2592e6:a.setDate(1);case 6048e5:b==6048e5&&a.setDate(a.getDate()-a.getDay());case 864e5:a.setHours(0);case 36e5:a.setMinutes(0);case 6e4:a.setSeconds(0);case 1e3:a.setMilliseconds(0)}},m,n,o,p=1;k>=94608e6?(m=31536e6,n="%Y",o=function(a){a.setFullYear(a.getFullYear()+p)}):k>=7776e6?(m=2592e6,n="%m/%Y",o=function(a){a.setMonth(a.getMonth()+p)}):k>=18144e5?(m=6048e5,n="%m/%d",o=function(a){a.setDate(a.getDate()+7*p)}):k>=2592e5?(m=864e5,n="%m/%d",o=function(a){a.setDate(a.getDate()+p)}):k>=108e5?(m=36e5,n="%I:%M %p",o=function(a){a.setHours(a.getHours()+p)}):k>=18e4?(m=6e4,n="%I:%M %p",o=function(a){a.setMinutes(a.getMinutes()+p)}):k>=3e3?(m=1e3,n="%I:%M:%S",o=function(a){a.setSeconds(a.getSeconds()+p)}):(m=1,n="%S.%Qs",o=function(a){a.setTime(a.getTime()+p)}),i=pv.Format.date(n);var q=new Date(g),r=[];l(q,m);var s=k/m;if(s>10)switch(m){case 36e5:p=s>20?6:3,q.setHours(Math.floor(q.getHours()/p)*p);break;case 2592e6:p=3,q.setMonth(Math.floor(q.getMonth()/p)*p);break;case 6e4:p=s>30?15:s>15?10:5,q.setMinutes(Math.floor(q.getMinutes()/p)*p);break;case 1e3:p=s>90?15:s>60?10:5,q.setSeconds(Math.floor(q.getSeconds()/p)*p);break;case 1:p=s>1e3?250:s>200?100:s>100?50:s>50?25:5,q.setMilliseconds(Math.floor(q.getMilliseconds()/p)*p);break;default:p=pv.logCeil(s/15,10),s/p<2?p/=5:s/p<5&&(p/=2),q.setFullYear(Math.floor(q.getFullYear()/p)*p)}for(;;){o(q);if(q>h)break;r.push(new Date(q))}return f?r.reverse():r}arguments.length||(b=10);var p=pv.logFloor(k/b,10),t=b/(k/p);t<=.15?p*=10:t<=.35?p*=5:t<=.75&&(p*=2);var c=Math.ceil(g/p)*p,d=Math.floor(h/p)*p;i=pv.Format.number().fractionDigits(Math.max(0,-Math.floor(pv.log(p,10)+.01)));var u=pv.range(c,d+p,p);return f?u.reverse():u},k.tickFormat=function(a){return i(a)},k.nice=function(){if(a.length!=2)return this;var c=a[0],d=a[a.length-1],e=d<c,f=e?d:c,h=e?c:d,i=h-f;if(!i||!isFinite(i))return this;var j=Math.pow(10,Math.round(Math.log(i)/Math.log(10))-1);return a=[Math.floor(f/j)*j,Math.ceil(h/j)*j],e&&a.reverse(),b=a.map(g),this},k.by=function(a){function b(){return k(a.apply(this,arguments))}for(var c in k)b[c]=k[c];return b},k.domain.apply(k,arguments),k},pv.Scale.linear=function(){var a=pv.Scale.quantitative();return a.domain.apply(a,arguments),a},pv.Scale.log=function(){var a=pv.Scale.quantitative(1,10),b,c,d=function(a){return Math.log(a)/c},e=function(a){return Math.pow(b,a)};return a.ticks=function(){var c=a.domain(),f=c[0]<0,g=Math.floor(f?-d(-c[0]):d(c[0])),h=Math.ceil(f?-d(-c[1]):d(c[1])),i=[];if(f){i.push(-e(-g));for(;g++<h;)for(var j=b-1;j>0;j--)i.push(-e(-g)*j)}else{for(;g<h;g++)for(var j=1;j<b;j++)i.push(e(g)*j);i.push(e(g))}for(g=0;i[g]<c[0];g++);for(h=i.length;i[h-1]>c[1];h--);return i.slice(g,h)},a.tickFormat=function(a){return a.toPrecision(1)},a.nice=function(){var c=a.domain();return a.domain(pv.logFloor(c[0],b),pv.logCeil(c[1],b))},a.base=function(f){return arguments.length?(b=Number(f),c=Math.log(b),a.transform(d,e),this):b},a.domain.apply(a,arguments),a.base(10)},pv.Scale.root=function(){var a=pv.Scale.quantitative();return a.power=function(b){var c=Number(b||0),d=1/c;return arguments.length?(a.transform(function(a){return Math.pow(a,d)},function(a){return Math.pow(a,c)}),this):c},a.domain.apply(a,arguments),a.power(2)},pv.Scale.ordinal=function(){function e(d){return d in b||(b[d]=a.push(d)-1),c[b[d]%c.length]}var a=[],b={},c=[],d=0;return e.domain=function(c,d){if(arguments.length){c=Array.isArray(c)?arguments.length>1?pv.map(c,d):c:Array.prototype.slice.call(arguments),a=[];var e={};for(var f=0;f<c.length;f++){var g=c[f];g in e||(e[g]=!0,a.push(g))}return b=pv.numerate(a),this}return a},e.range=function(a,b){return arguments.length?(c=Array.isArray(a)?arguments.length>1?pv.map(a,b):a:Array.prototype.slice.call(arguments),typeof c[0]=="string"&&(c=c.map(pv.color)),this):c},e.split=function(a,b){var d=(b-a)/this.domain().length;return c=pv.range(a+d/2,b,d),this},e.splitFlush=function(a,b){var d=this.domain().length,e=(b-a)/(d-1);return c=d==1?[(a+b)/2]:pv.range(a,b+e/2,e),this},e.splitBanded=function(a,b,d){arguments.length<3&&(d=1);if(d<0){var e=this.domain().length,f=-d*e,g=b-a-f,h=g/(e+1);c=pv.range(a+h,b,h-d),c.band=-d}else{var i=(b-a)/(this.domain().length+(1-d));c=pv.range(a+i*(1-d),b,i),c.band=i*d}return this},e.by=function(a){function b(){return e(a.apply(this,arguments))}for(var c in e)b[c]=e[c];return b},e.domain.apply(e,arguments),e},pv.Scale.quantile=function(){function f(a){return e(Math.max(0,Math.min(b,pv.search.index(c,a)-1))/b)}var a=-1,b=-1,c=[],d=[],e=pv.Scale.linear();return f.quantiles=function(e){if(arguments.length){a=Number(e);if(a<0)c=[d[0]].concat(d),b=d.length-1;else{c=[],c[0]=d[0];for(var f=1;f<=a;f++)c[f]=d[~~(f*(d.length-1)/a)];b=a-1}return this}return c},f.domain=function(b,c){return arguments.length?(d=Array.isArray(b)?pv.map(b,c):Array.prototype.slice.call(arguments),d.sort(pv.naturalOrder),f.quantiles(a),this):d},f.range=function(){return arguments.length?(e.range.apply(e,arguments),this):e.range()},f.by=function(a){function b(){return f(a.apply(this,arguments))}for(var c in f)b[c]=f[c];return b},f.domain.apply(f,arguments),f},pv.histogram=function(a,b){var c=!0;return{bins:function(d){var e=pv.map(a,b),g=[];arguments.length||(d=pv.Scale.linear(e).ticks());for(var h=0;h<d.length-1;h++){var i=g[h]=[];i.x=d[h],i.dx=d[h+1]-d[h],i.y=0}for(var h=0;h<e.length;h++){var j=pv.search.index(d,e[h])-1,i=g[Math.max(0,Math.min(g.length-1,j))];i.y++,i.push(a[h])}if(!c)for(var h=0;h<g.length;h++)g[h].y/=e.length;return g},frequency:function(a){return arguments.length?(c=Boolean(a),this):c}}},pv.color=function(a){if(a.rgb)return a.rgb();a=a.toLowerCase();var b=/([a-z]+)\((.*)\)/i.exec(a);if(b){var c=b[2].split(","),d=1;switch(b[1]){case"hsla":case"rgba":d=parseFloat(c[3]);if(!d)return pv.Color.transparent}switch(b[1]){case"hsla":case"hsl":var e=parseFloat(c[0]),f=parseFloat(c[1])/100,g=parseFloat(c[2])/100;return(new pv.Color.Hsl(e,f,g,d)).rgb();case"rgba":case"rgb":var h=function(a){var b=parseFloat(a);return a[a.length-1]=="%"?Math.round(b*2.55):b},i=h(c[0]),j=h(c[1]),k=h(c[2]);return pv.rgb(i,j,k,d)}}var l=pv.Color.names[a];if(l)return l;if(a.charAt(0)=="#"){var i,j,k;return a.length==4?(i=a.charAt(1),i+=i,j=a.charAt(2),j+=j,k=a.charAt(3),k+=k):a.length==7&&(i=a.substring(1,3),j=a.substring(3,5),k=a.substring(5,7)),pv.rgb(parseInt(i,16),parseInt(j,16),parseInt(k,16),1)}return new pv.Color(a,1)},pv.Color=function(a,b){this.color=a,this.opacity=b},pv.Color.prototype.toString=function(){return this.color},pv.Color.prototype.brighter=function(a){return this.rgb().brighter(a)},pv.Color.prototype.darker=function(a){return this.rgb().darker(a)},pv.rgb=function(a,b,c,d){return new pv.Color.Rgb(a,b,c,arguments.length==4?d:1)},pv.Color.Rgb=function(a,b,c,d){a=~~a<0?0:~~a>255?255:~~a,b=~~b<0?0:~~b>255?255:~~b,c=~~c<0?0:~~c>255?255:~~c,d=d<0?0:d>1?1:d,pv.Color.call(this,d?"rgb("+a+","+b+","+c+")":"none",d),this.r=a,this.g=b,this.b=c,this.a=d},pv.Color.Rgb.prototype=pv.extend(pv.Color),pv.Color.Rgb.prototype.red=function(a){return pv.rgb(a,this.g,this.b,this.a)},pv.Color.Rgb.prototype.green=function(a){return pv.rgb(this.r,a,this.b,this.a)},pv.Color.Rgb.prototype.blue=function(a){return pv.rgb(this.r,this.g,a,this.a)},pv.Color.Rgb.prototype.
alpha=function(a){return pv.rgb(this.r,this.g,this.b,a)},pv.Color.Rgb.prototype.rgb=function(){return this},pv.Color.Rgb.prototype.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return!b&&!c&&!d?pv.rgb(e,e,e,this.a):(b&&b<e&&(b=e),c&&c<e&&(c=e),d&&d<e&&(d=e),pv.rgb(Math.min(255,Math.floor(b/a)),Math.min(255,Math.floor(c/a)),Math.min(255,Math.floor(d/a)),this.a))},pv.Color.Rgb.prototype.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),pv.rgb(Math.max(0,Math.floor(a*this.r)),Math.max(0,Math.floor(a*this.g)),Math.max(0,Math.floor(a*this.b)),this.a)},pv.hsl=function(a,b,c,d){return new pv.Color.Hsl(a,b,c,arguments.length==4?d:1)},pv.Color.Hsl=function(a,b,c,d){pv.Color.call(this,"hsl("+a+","+b*100+"%,"+c*100+"%)",d),this.h=a,this.s=b,this.l=c,this.a=d},pv.Color.Hsl.prototype=pv.extend(pv.Color),pv.Color.Hsl.prototype.hue=function(a){return pv.hsl(a,this.s,this.l,this.a)},pv.Color.Hsl.prototype.saturation=function(a){return pv.hsl(this.h,a,this.l,this.a)},pv.Color.Hsl.prototype.lightness=function(a){return pv.hsl(this.h,this.s,a,this.a)},pv.Color.Hsl.prototype.alpha=function(a){return pv.hsl(this.h,this.s,this.l,a)},pv.Color.Hsl.prototype.rgb=function(){function f(a){return a>360?a-=360:a<0&&(a+=360),a<60?e+(d-e)*a/60:a<180?d:a<240?e+(d-e)*(240-a)/60:e}function g(a){return Math.round(f(a)*255)}var a=this.h,b=this.s,c=this.l;a=a%360,a<0&&(a+=360),b=Math.max(0,Math.min(b,1)),c=Math.max(0,Math.min(c,1));var d=c<=.5?c*(1+b):c+b-c*b,e=2*c-d;return pv.rgb(g(a+120),g(a),g(a-120),this.a)},pv.Color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:pv.Color.transparent=pv.rgb(0,0,0,0)},function(){var a=pv.Color.names;for(var b in a)a[b]=pv.color(a[b])}(),pv.colors=function(){var a=pv.Scale.ordinal();return a.range.apply(a,arguments),a},pv.Colors={},pv.Colors.category10=function(){var a=pv.colors("#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf");return a.domain.apply(a,arguments),a},pv.Colors.category20=function(){var a=pv.colors("#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5");return a.domain.apply(a,arguments),a},pv.Colors.category19=function(){var a=pv.colors("#9c9ede","#7375b5","#4a5584","#cedb9c","#b5cf6b","#8ca252","#637939","#e7cb94","#e7ba52","#bd9e39","#8c6d31","#e7969c","#d6616b","#ad494a","#843c39","#de9ed6","#ce6dbd","#a55194","#7b4173");return a.domain.apply(a,arguments),a},pv.ramp=function(a,b){var c=pv.Scale.linear();return c.range.apply(c,arguments),c},pv.Scene=pv.SvgScene={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml",scale:1,events:["DOMMouseScroll","mousewheel","mousedown","mouseup","mouseover","mouseout","mousemove","click","dblclick"],implicit:{svg:{"shape-rendering":"auto","pointer-events":"painted",x:0,y:0,dy:0,"text-anchor":"start",transform:"translate(0,0)",fill:"none","fill-opacity":1,stroke:"none","stroke-opacity":1,"stroke-width":1.5,"stroke-linejoin":"miter"},css:{font:"10px sans-serif"}}},pv.SvgScene.data=function(a,b,c){var d=a.$pv||(a.$pv={});return arguments.length>2?d[b]=c:arguments.length===1?d:d[b]},pv.SvgScene.updateAll=function(a){if(a.length&&a[0].reverse&&a.type!="line"&&a.type!="area"){var b=pv.extend(a);for(var c=0,d=a.length-1;d>=0;c++,d--)b[c]=a[d];a=b}this.removeSiblings(this[a.type](a))},pv.SvgScene.create=function(a){return document.createElementNS(this.svg,a)},pv.SvgScene.expect=function(a,b,c,d){if(a){a.tagName=="a"&&(a=a.firstChild);if(a.tagName!=b){var e=this.create(b);a.parentNode.replaceChild(e,a),a=e}}else a=this.create(b);var f=this.data(a,"attr")||{},g=this.implicit.svg;for(var h in c){var i=c[h];i!==f[h]&&(i===null||i===g[h]?a.removeAttribute(h):a.setAttribute(h,i))}this.data(a,"attr",c);for(var h in d){var i=d[h],j=a.style[h];i==this.implicit.css[h]&&(i=null),j!=i&&(i==null?a.style[h]&&a.style.removeProperty(h):a.style[h]=i)}return a},pv.SvgScene.append=function(a,b,c){return this.data(a,"index",c),this.data(a,"scenes",b),a=this.title(a,b[c]),a.parentNode||b.$g.appendChild(a),a.nextSibling},pv.SvgScene.title=function(a,b){var c=a.getElementsByTagName("title")[0];return b.title?c?c.firstChild.nodeValue=b.title:(c=a.appendChild(pv.SvgScene.create("title")),c.appendChild(document.createTextNode(b.title))):c&&c.removeChild(c),a},pv.SvgScene.dispatch=pv.listener(function(a){var b=pv.SvgScene.data(a.target);if(b.scenes){var c=a.type;switch(c){case"DOMMouseScroll":c="mousewheel",a.wheel=-480*a.detail;break;case"mousewheel":a.wheel=(window.opera?12:1)*a.wheelDelta}pv.Mark.dispatch(c,b.scenes,b.index)&&a.preventDefault()}}),pv.SvgScene.removeSiblings=function(a){while(a){var b=a.nextSibling;a.parentNode.removeChild(a),a=b}},pv.SvgScene["undefined"]=function(){},pv.SvgScene.pathBasis=function(){function b(a,b,c,d,e){return{x:a[0]*b.left+a[1]*c.left+a[2]*d.left+a[3]*e.left,y:a[0]*b.top+a[1]*c.top+a[2]*d.top+a[3]*e.top}}var a=[[1/6,2/3,1/6,0],[0,2/3,1/3,0],[0,1/3,2/3,0],[0,1/6,2/3,1/6]],c=function(c,d,e,f){var g=b(a[1],c,d,e,f),h=b(a[2],c,d,e,f),i=b(a[3],c,d,e,f);return"C"+g.x+","+g.y+","+h.x+","+h.y+","+i.x+","+i.y};return c.segment=function(c,d,e,f){var g=b(a[0],c,d,e,f),h=b(a[1],c,d,e,f),i=b(a[2],c,d,e,f),j=b(a[3],c,d,e,f);return"M"+g.x+","+g.y+"C"+h.x+","+h.y+","+i.x+","+i.y+","+j.x+","+j.y},c}(),pv.SvgScene.curveBasis=function(a){if(a.length<=2)return"";var b="",c=a[0],d=c,e=c,f=a[1];b+=this.pathBasis(c,d,e,f);for(var g=2;g<a.length;g++)c=d,d=e,e=f,f=a[g],b+=this.pathBasis(c,d,e,f);return b+=this.pathBasis(d,e,f,f),b+=this.pathBasis(e,f,f,f),b},pv.SvgScene.curveBasisSegments=function(a){if(a.length<=2)return"";var b=[],c=a[0],d=c,e=c,f=a[1],g=this.pathBasis.segment(c,d,e,f);c=d,d=e,e=f,f=a[2],b.push(g+this.pathBasis(c,d,e,f));for(var h=3;h<a.length;h++)c=d,d=e,e=f,f=a[h],b.push(this.pathBasis.segment(c,d,e,f));return b.push(this.pathBasis.segment(d,e,f,f)+this.pathBasis(e,f,f,f)),b},pv.SvgScene.curveHermite=function(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return"";var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;c&&(d+="Q"+(f.left-g.x*2/3)+","+(f.top-g.y*2/3)+","+f.left+","+f.top,e=a[1],i=2);if(b.length>1){h=b[1],f=a[i],i++,d+="C"+(e.left+g.x)+","+(e.top+g.y)+","+(f.left-h.x)+","+(f.top-h.y)+","+f.left+","+f.top;for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f.left-h.x)+","+(f.top-h.y)+","+f.left+","+f.top}if(c){var k=a[i];d+="Q"+(f.left+h.x*2/3)+","+(f.top+h.y*2/3)+","+k.left+","+k.top}return d},pv.SvgScene.curveHermiteSegments=function(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return[];var c=a.length!=b.length,d=[],e=a[0],f=e,g=b[0],h=g,i=1;c&&(f=a[1],d.push("M"+e.left+","+e.top+"Q"+(f.left-h.x*2/3)+","+(f.top-h.y*2/3)+","+f.left+","+f.top),i=2);for(var j=1;j<b.length;j++,i++)e=f,g=h,f=a[i],h=b[j],d.push("M"+e.left+","+e.top+"C"+(e.left+g.x)+","+(e.top+g.y)+","+(f.left-h.x)+","+(f.top-h.y)+","+f.left+","+f.top);if(c){var k=a[i];d.push("M"+f.left+","+f.top+"Q"+(f.left+h.x*2/3)+","+(f.top+h.y*2/3)+","+k.left+","+k.top)}return d},pv.SvgScene.cardinalTangents=function(a,b){var c=[],d=(1-b)/2,e=a[0],f=a[1],g=a[2];for(var h=3;h<a.length;h++)c.push({x:d*(g.left-e.left),y:d*(g.top-e.top)}),e=f,f=g,g=a[h];return c.push({x:d*(g.left-e.left),y:d*(g.top-e.top)}),c},pv.SvgScene.curveCardinal=function(a,b){return a.length<=2?"":this.curveHermite(a,this.cardinalTangents(a,b))},pv.SvgScene.curveCardinalSegments=function(a,b){return a.length<=2?"":this.curveHermiteSegments(a,this.cardinalTangents(a,b))},pv.SvgScene.monotoneTangents=function(a){var b=[],c=[],d=[],e=[],f=0;for(f=0;f<a.length-1;f++)c[f]=(a[f+1].top-a[f].top)/(a[f+1].left-a[f].left);d[0]=c[0],e[0]=a[1].left-a[0].left;for(f=1;f<a.length-1;f++)d[f]=(c[f-1]+c[f])/2,e[f]=(a[f+1].left-a[f-1].left)/2;d[f]=c[f-1],e[f]=a[f].left-a[f-1].left;for(f=0;f<a.length-1;f++)c[f]===0&&(d[f]=0,d[f+1]=0);for(f=0;f<a.length-1;f++){if(Math.abs(d[f])<1e-5||Math.abs(d[f+1])<1e-5)continue;var g=d[f]/c[f],h=d[f+1]/c[f],i=g*g+h*h;if(i>9){var j=3/Math.sqrt(i);d[f]=j*g*c[f],d[f+1]=j*h*c[f]}}var k;for(var l=0;l<a.length;l++)k=1+d[l]*d[l],b.push({x:e[l]/3/k,y:d[l]*e[l]/3/k});return b},pv.SvgScene.curveMonotone=function(a){return a.length<=2?"":this.curveHermite(a,this.monotoneTangents(a))},pv.SvgScene.curveMonotoneSegments=function(a){return a.length<=2?"":this.curveHermiteSegments(a,this.monotoneTangents(a))},pv.SvgScene.area=function(a){function f(b,d){var e=[],f=[];for(var g=d;b<=g;b++,d--){var h=a[b],i=a[d],j=h.left+","+h.top,k=i.left+i.width+","+(i.top+i.height);if(b<g){var l=a[b+1],m=a[d-1];switch(c.interpolate){case"step-before":j+="V"+l.top,k+="H"+(m.left+m.width);break;case"step-after":j+="H"+l.left,k+="V"+(m.top+m.height)}}e.push(j),f.push(k)}return e.concat(f).join("L")}function g(b,d){var e=[],f=[],g,h;for(var i=d;b<=i;b++,d--){var j=a[d];e.push(a[b]),f.push({left:j.left+j.width,top:j.top+j.height})}return c.interpolate=="basis"?(g=pv.SvgScene.curveBasis(e),h=pv.SvgScene.curveBasis(f)):c.interpolate=="cardinal"?(g=pv.SvgScene.curveCardinal(e,c.tension),h=pv.SvgScene.curveCardinal(f,c.tension)):(g=pv.SvgScene.curveMonotone(e),h=pv.SvgScene.curveMonotone(f)),e[0].left+","+e[0].top+g+"L"+f[0].left+","+f[0].top+h}var b=a.$g.firstChild;if(!a.length)return b;var c=a[0];if(c.segmented)return this.areaSegment(a);if(!c.visible)return b;var d=c.fillStyle,e=c.strokeStyle;if(!d.opacity&&!e.opacity)return b;var h=[],i,j;for(var k=0;k<a.length;k++){i=a[k];if(!i.width&&!i.height)continue;for(var l=k+1;l<a.length;l++){j=a[l];if(!j.width&&!j.height)break}k&&c.interpolate!="step-after"&&k--,l<a.length&&c.interpolate!="step-before"&&l++,h.push((l-k>2&&(c.interpolate=="basis"||c.interpolate=="cardinal"||c.interpolate=="monotone")?g:f)(k,l-1)),k=l-1}return h.length?(b=this.expect(b,"path",{"shape-rendering":c.antialias?null:"crispEdges","pointer-events":c.events,cursor:c.cursor,d:"M"+h.join("ZM")+"Z",fill:d.color,"fill-opacity":d.opacity||null,stroke:e.color,"stroke-dasharray":c.lineDash,"stroke-opacity":e.opacity||null,"stroke-width":e.opacity?c.lineWidth/this.scale:null}),this.append(b,a,0)):b},pv.SvgScene.areaSegment=function(a){var b=a.$g.firstChild,c=a[0],d,e;if(c.interpolate=="basis"||c.interpolate=="cardinal"||c.interpolate=="monotone"){var f=[],g=[];for(var h=0,i=a.length;h<i;h++){var j=a[i-h-1];f.push(a[h]),g.push({left:j.left+j.width,top:j.top+j.height})}c.interpolate=="basis"?(d=this.curveBasisSegments(f),e=this.curveBasisSegments(g)):c.interpolate=="cardinal"?(d=this.curveCardinalSegments(f,c.tension),e=this.curveCardinalSegments(g,c.tension)):(d=this.curveMonotoneSegments(f),e=this.curveMonotoneSegments(g))}for(var h=0,i=a.length-1;h<i;h++){var k=a[h],l=a[h+1];if(!k.visible||!l.visible)continue;var m=k.fillStyle,n=k.strokeStyle;if(!m.opacity&&!n.opacity)continue;var o;if(d){var p=d[h],q="L"+e[i-h-1].substr(1);o=p+q+"Z"}else{var r=k,j=l;switch(k.interpolate){case"step-before":r=l;break;case"step-after":j=k}o="M"+k.left+","+r.top+"L"+l.left+","+j.top+"L"+(l.left+l.width)+","+(j.top+j.height)+"L"+(k.left+k.width)+","+(r.top+r.height)+"Z"}b=this.expect(b,"path",{"shape-rendering":k.antialias?null:"crispEdges","pointer-events":k.events,cursor:k.cursor,d:o,fill:m.color,"fill-opacity":m.opacity||null,stroke:n.color,"stroke-dasharray":c.lineDash,"stroke-opacity":n.opacity||null,"stroke-width":n.opacity?k.lineWidth/this.scale:null}),b=this.append(b,a,h)}return b},pv.SvgScene.bar=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;var e=d.fillStyle,f=d.strokeStyle;if(!e.opacity&&!f.opacity)continue;b=this.expect(b,"rect",{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x:d.left,y:d.top,width:Math.max(1e-10,d.width),height:Math.max(1e-10,d.height),fill:e.color,"fill-opacity":e.opacity||null,stroke:f.color,"stroke-dasharray":d.lineDash,"stroke-opacity":f.opacity||null,"stroke-width":f.opacity?d.lineWidth/this.scale:null}),b=this.append(b,a,c)}return b},pv.SvgScene.dot=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;var e=d.fillStyle,f=d.strokeStyle;if(!e.opacity&&!f.opacity)continue;var g=d.radius,h=null;switch(d.shape){case"cross":h="M"+ -g+","+ -g+"L"+g+","+g+"M"+g+","+ -g+"L"+ -g+","+g;break;case"triangle":var i=g,j=g*1.1547;h="M0,"+i+"L"+j+","+ -i+" "+ -j+","+ -i+"Z";break;case"diamond":g*=Math.SQRT2,h="M0,"+ -g+"L"+g+",0"+" 0,"+g+" "+ -g+",0"+"Z";break;case"square":h="M"+ -g+","+ -g+"L"+g+","+ -g+" "+g+","+g+" "+ -g+","+g+"Z";break;case"tick":h="M0,0L0,"+ -d.size;break;case"bar":h="M0,"+d.size/2+"L0,"+ -(d.size/2)}var k={"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,fill:e.color,"fill-opacity":e.opacity||null,stroke:f.color,"stroke-opacity":f.opacity||null,"stroke-dasharray":d.lineDash,"stroke-width":f.opacity?d.lineWidth/this.scale:null};h?(k.transform="translate("+d.left+","+d.top+")",d.angle&&(k.transform+=" rotate("+180*d.angle/Math.PI+")"),k.d=h,b=this.expect(b,"path",k)):(k.cx=d.left,k.cy=d.top,k.r=g,b=this.expect(b,"circle",k)),b=this.append(b,a,c)}return b},pv.SvgScene.image=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;b=this.fill(b,a,c);if(d.image){b=this.expect(b,"foreignObject",{cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height});var e=b.firstChild||b.appendChild(document.createElementNS(this.xhtml,"canvas"));this.data(e,"index",c),this.data(e,"scenes",a),e.style.width=d.width,e.style.height=d.height,e.width=d.imageWidth,e.height=d.imageHeight,e.getContext("2d").putImageData(d.image,0,0)}else b=this.expect(b,"image",{preserveAspectRatio:"none",cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height}),b.setAttributeNS(this.xlink,"href",d.url);b=this.append(b,a,c),b=this.stroke(b,a,c)}return b},pv.SvgScene.label=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;var e=d.textStyle;if(!e.opacity||!d.text)continue;var f=0,g=0,h=0,i="start";switch(d.textBaseline){case"middle":h=".35em";break;case"top":h=".71em",g=d.textMargin;break;case"bottom":h="-.01em",g="-"+d.textMargin}switch(d.textAlign){case"right":i="end",f="-"+d.textMargin;break;case"center":i="middle";break;case"left":f=d.textMargin}b=this.expect(b,"text",{"pointer-events":d.events,cursor:d.cursor,x:f,y:g,dy:h,transform:"translate("+d.left+","+d.top+")"+(d.textAngle?" rotate("+180*d.textAngle/Math.PI+")":"")+(this.scale!=1?" scale("+1/this.scale+")":""),fill:e.color,"fill-opacity":e.opacity||null,"text-anchor":i},{font:d.font,"text-shadow":d.textShadow,"text-decoration":d.textDecoration}),b.firstChild?b.firstChild.nodeValue=d.text:b.appendChild(document.createTextNode(d.text)),b=this.append(b,a,c)}return b},pv.SvgScene.line=function(a){var b=a.$g.firstChild;if(a.length<2)return b;var c=a[0];if(c.segmented)return this.lineSegment(a);if(!c.visible)return b;var d=c.fillStyle,e=c.strokeStyle,f;if(!d.opacity&&!e.opacity)return b;if(c.segmented===null&&c.interpolate==="linear"){f="M"+c.left+","+c.top;for(var g=0,h=a.length;g<h;g++){var i=a[g];f+="L"+i.left+","+i.top}}else{f="M"+c.left+","+c.top;if(a.length>2&&(c.interpolate=="basis"||c.interpolate=="cardinal"||c.interpolate=="monotone"))switch(c.interpolate){case"basis":f+=this.curveBasis(a);break;case"cardinal":f+=this.curveCardinal(a,c.tension);break;case"monotone":f+=this.curveMonotone(a)}else for(var j=1;j<a.length;j++)f+=this.pathSegment(a[j-1],a[j])}return b=this.expect(b,"path",{"shape-rendering":c.antialias?null:"crispEdges","pointer-events":c.events,cursor:c.cursor,d:f,fill:d.color,"fill-opacity":d.opacity||null,stroke:e.color,"stroke-opacity":e.opacity||null,"stroke-width":e.opacity?c.lineWidth/this.scale:null,"stroke-dasharray":c.lineDash,"stroke-linejoin":c.lineJoin}),this.append(b,a,0)},pv.SvgScene.lineSegment=function(a){var b=a.$g.firstChild,c=a[0],d;switch(c.interpolate){case"basis":d=this.curveBasisSegments(a);break;case"cardinal":d=this.curveCardinalSegments(a,c.tension);break;case"monotone":d=this.curveMonotoneSegments(a)}for(var e=0,f=a.length-1;e<f;e++){var g=a[e],h=a[e+1];if(!g.visible||!h.visible)continue;var i=g.strokeStyle,j=pv.Color.transparent;if(!i.opacity)continue;var k;g.interpolate=="linear"&&g.lineJoin=="miter"?(j=i,i=pv.Color.transparent,k=this.pathJoin(a[e-1],g,h,a[e+2])):d?k=d[e]:k="M"+g.left+","+g.top+this.pathSegment(g,h),b=this.expect(b,"path",{"shape-rendering":g.antialias?null:"crispEdges","pointer-events":g.events,cursor:g.cursor,d:k,fill:j.color,"fill-opacity":j.opacity||null,stroke:i.color,"stroke-opacity":i.opacity||null,"stroke-width":i.opacity?g.lineWidth/this.scale:null,"stroke-linejoin":g.lineJoin}),b=this.append(b,a,e)}return b},pv.SvgScene.pathSegment=function(a,b){var c=1;switch(a.interpolate){case"polar-reverse":c=0;case"polar":var d=b.left-a.left,e=b.top-a.top,f=1-a.eccentricity,g=Math.sqrt(d*d+e*e)/(2*f);if(f<=0||f>1)break;return"A"+g+","+g+" 0 0,"+c+" "+b.left+","+b.top;case"step-before":return"V"+b.top+"H"+b.left;case"step-after":return"H"+b.left+"V"+b.top}return"L"+b.left+","+b.top},pv.SvgScene.lineIntersect=function(a,b,c,d){return a.plus(b.times(c.minus(a).dot(d.perp())/b.dot(d.perp())))},pv.SvgScene.pathJoin=function(a,b,c,d){var e=pv.vector(b.left,b.top),f=pv.vector(c.left,c.top),g=f.minus(e),h=g.perp().norm(),i=h.times(b.lineWidth/(2*this.scale)),j=e.plus(i),k=f.plus(i),l=f.minus(i),m=e.minus(i);if(a&&a.visible){var n=e.minus(a.left,a.top).perp().norm().plus(h);m=this.lineIntersect(e,n,m,g),j=this.lineIntersect(e,n,j,g)}if(d&&d.visible){var o=pv.vector(d.left,d.top).minus(f).perp().norm().plus(h);l=this.lineIntersect(f,o,l,g),k=this.lineIntersect(f,o,k,g)}return"M"+j.x+","+j.y+"L"+k.x+","+k.y+" "+l.x+","+l.y+" "+m.x+","+m.y},pv.SvgScene.panel=function(a){var b=a.$g,c=b&&b.firstChild;for(var d=0;d<a.length;d++){var e=a[d];if(!e.visible)continue;if(!a.parent){e.canvas.style.display="inline-block",b&&b.parentNode!=e.canvas&&(b=e.canvas.firstChild,c=b&&b.firstChild);if(!b){b=e.canvas.appendChild(this.create("svg")),b.setAttribute("font-size","10px"),b.setAttribute("font-family","sans-serif"),b.setAttribute("fill","none"),b.setAttribute("stroke","none"),b.setAttribute("stroke-width",1.5);for(var f=0;f<this.events.length;f++)b.addEventListener(this.events[f],this.dispatch,!1);c=b.firstChild}a.$g=b,b.setAttribute("width",e.width+e.left+e.right),b.setAttribute("height",e.height+e.top+e.bottom)}var g;if(e.overflow=="hidden"){var h=pv.id().toString(36),g=this.expect(c,"g",{"clip-path":"url(#"+h+")"});g.parentNode||b.appendChild(g),a.$g=b=g,c=g.firstChild,c=this.expect(c,"clipPath",{id:h});var i=c.firstChild||c.appendChild(this.create("rect"));i.setAttribute("x",e.left),i.setAttribute("y",e.top),i.setAttribute("width",e.width),i.setAttribute("height",e.height),c.parentNode||b.appendChild(c),c=c.nextSibling}c=this.fill(c,a,d);var j=this.scale,k=e.transform,l=e.left+k.x,m=e.top+k.y;this.scale*=k.k;for(var f=0;f<e.children.length;f++)e.children[f].$g=c=this.expect(c,"g",{transform:"translate("+l+","+m+")"+(k.k!=1?" scale("+k.k+")":"")}),this.updateAll(e.children[f]),c.parentNode||b.appendChild(c),c=c.nextSibling;this.scale=j,c=this.stroke(c,a,d),e.overflow=="hidden"&&(a.$g=b=g.parentNode,c=g.nextSibling)}return c},pv.SvgScene.fill=function(a,b,c){var d=b[c],e=d.fillStyle;if(e.opacity||d.events=="all")a=this.expect(a,"rect",{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height,fill:e.color,"fill-opacity":e.opacity,stroke:null}),a=this.append(a,b,c);return a},pv.SvgScene.stroke=function(a,b,c){var d=b[c],e=d.strokeStyle;if(e.opacity||d.events=="all")a=this.expect(a,"rect",{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events=="all"?"stroke":d.events,cursor:d.cursor,x:d.left,y:d.top,width:Math.max(1e-10,d.width),height:Math.max(1e-10,d.height),fill:null,stroke:e.color,"stroke-opacity":e.opacity,"stroke-dasharray":d.lineDash,"stroke-width":d.lineWidth/this.scale}),a=this.append(a,b,c);return a},pv.SvgScene.rule=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;var e=d.strokeStyle;if(!e.opacity)continue;b=this.expect(b,"line",{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x1:d.left,y1:d.top,x2:d.left+d.width,y2:d.top+d.height,stroke:e.color,"stroke-opacity":e.opacity,"stroke-dasharray":d.lineDash,"stroke-width":d.lineWidth/this.scale}),b=this.append(b,a,c)}return b},pv.SvgScene.wedge=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;var e=d.fillStyle,f=d.strokeStyle;if(!e.opacity&&!f.opacity)continue;var g=d.innerRadius,h=d.outerRadius,i=Math.abs(d.angle),j;if(i>=2*Math.PI)g?j="M0,"+h+"A"+h+","+h+" 0 1,1 0,"+ -h+"A"+h+","+h+" 0 1,1 0,"+h+"M0,"+g+"A"+g+","+g+" 0 1,1 0,"+ -g+"A"+g+","+g+" 0 1,1 0,"+g+"Z":j="M0,"+h+"A"+h+","+h+" 0 1,1 0,"+ -h+"A"+h+","+h+" 0 1,1 0,"+h+"Z";else{var k=Math.min(d.startAngle,d.endAngle),l=Math.max(d.startAngle,d.endAngle),m=Math.cos(k),n=Math.cos(l),o=Math.sin(k),p=Math.sin(l);g?j="M"+h*m+","+h*o+"A"+h+","+h+" 0 "+(i<Math.PI?"0":"1")+",1 "+h*n+","+h*p+"L"+g*n+","+g*p+"A"+g+","+g+" 0 "+(i<Math.PI?"0":"1")+",0 "+g*m+","+g*o+"Z":j="M"+h*m+","+h*o+"A"+h+","+h+" 0 "+(i<Math.PI?"0":"1")+",1 "+h*n+","+h*p+"L0,0Z"}b=this.expect(b,"path",{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,transform:"translate("+d.left+","+d.top+")",d:j,fill:e.color,"fill-rule":"evenodd","fill-opacity":e.opacity||null,stroke:f.color,"stroke-dasharray":d.lineDash,"stroke-opacity":f.opacity||null,"stroke-width":f.opacity?d.lineWidth/this.scale:null}),b=this.append(b,a,c)}return b},pv.Mark=function(){this.$properties=[],this.$handlers={}},pv.Mark.prototype.properties={},pv.Mark.cast={},pv.Mark.prototype.property=function(a,b){return this.hasOwnProperty("properties")||(this.properties=pv.extend(this.properties)),this.properties[a]=!0,pv.Mark.prototype.propertyMethod(a,!1,pv.Mark.cast[a]=b),this},pv.Mark.prototype.propertyMethod=function(a,b,c){c||(c=pv.Mark.cast[a]),this[a]=function(d){if(b&&this.scene){var e=this.scene.defs;return arguments.length?(e[a]={id:d==null?0:pv.id(),value:d!=null&&c?c(d):d},this):e[a]?e[a].value:null}if(arguments.length){var f=!b<<1|typeof d=="function";return this.propertyValue(a,f&1&&c?function(){var a=d.apply(this,arguments);return a!=null?c(a):null}:d!=null&&c?c(d):d).type=f,this}return this.instance()[a]}},pv.Mark.prototype.propertyValue=function(a,b){var c=this.$properties,d={name:a,id:pv.id(),value:b};for(var e=0;e<c.length;e++)if(c[e].name==a){c.splice(e,1);break}return c.push(d),d},pv.Mark.prototype.property("data").property("visible",Boolean).property("left",Number).property("right",Number).property("top",Number).property("bottom",Number).property("cursor",String).property("title",String).property("reverse",Boolean).property("antialias",Boolean).property("events",String).property("id",String),pv.Mark.prototype.childIndex=-1,pv.Mark.prototype.index=-1,pv.Mark.prototype.scale=1,pv.Mark.prototype.defaults=(new pv.Mark).data(function(a){return[a]}).visible(!0).antialias(!0).events("painted"),pv.Mark.prototype.extend=function(a){return this.proto=a,this.target=a.target,this},pv.Mark.prototype.add=function(a){return this.parent.add(a).extend(this)},pv.Mark.prototype.def=function(a,b){return this.propertyMethod(a,!0),this[a](arguments.length>1?b:null)},pv.Mark.prototype.anchor=function(a){return a||(a="center"),(new pv.Anchor(this)).name(a).data(function(){return this.scene.target.map(function(a){return a.data})}).visible(function(){return this.scene.target[this.index].visible}).id(function(){return this.scene.target[this.index].id}).left(function(){var a=this.scene.target[this.index],b=a.width||0;switch(this.name()){case"bottom":case"top":case"center":return a.left+b/2;case"left":return null}return a.left+b}).top(function(){var a=this.scene.target[this.index],b=a.height||0;switch(this.name()){case"left":case"right":case"center":return a.top+b/2;case"top":return null}return a.top+b}).right(function(){var a=this.scene.target[this.index];return this.name()=="left"?a.right+(a.width||0):null}).bottom(function(){var a=this.scene.target[this.index];return this.name()=="top"?a.bottom+(a.height||0):null}).textAlign(function(){switch(this.name()){case"bottom":case"top":case"center":return"center";case"right":return"right"}return"left"}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"top":return"top"}return"bottom"})},pv.Mark.prototype.anchorTarget=function(){return this.target},pv.Mark.prototype.margin=function(a){return this.left(a).right(a).top(a).bottom(a)},pv.Mark.prototype.instance=function(a){var b=this.scene||this.parent.instance(-1).children[this.childIndex],c=!arguments.length||this.hasOwnProperty("index")?this.index:a;return b[c<0?b.length-1:c]},pv.Mark.prototype.instances=function(a){var b=this,c=[],d;while(!(d=b.scene))a=a.parent,c.push({index:a.index,childIndex:b.childIndex}),b=b.parent;while(c.length){var e=c.pop();d=d[e.index].children[e.childIndex]}if(this.hasOwnProperty("index")){var f=pv.extend(d[this.index]);return f.right=f.top=f.left=f.bottom=0,[f]}return d},pv.Mark.prototype.first=function(){return this.scene[0]},pv.Mark.prototype.last=function(){return this.scene[this.scene.length-1]},pv.Mark.prototype.sibling=function(){return this.index===0?null:this.scene[this.index-1]},pv.Mark.prototype.cousin=function(){var a=this.parent,b=a&&a.sibling();return b&&b.children?b.children[this.childIndex][this.index]:null},pv.Mark.prototype.render=function(){function e(a,d,e){a.scale=e;if(d<c.length){b.unshift(null);if(a.hasOwnProperty("index"))f(a,d,e);else{for(var g=0,h=a.scene.length;g<h;g++)a.index=g,f(a,d,e);delete a.index}b.shift()}else a.build(),pv.Scene.scale=e,pv.Scene.updateAll(a.scene);delete a.scale}function f(a,d,f){var g=a.scene[a.index],h;if(g.visible){var i=c[d],j=a.children[i];for(h=0;h<i;h++)a.children[h].scene=g.children[h];b[0]=g.data,j.scene?e(j,d+1,f*g.transform.k):(j.scene=g.children[i],e(j,d+1,f*g.transform.k),delete j.scene);for(h=0;h<i;h++)delete a.children[h].scene}}var a=this.parent,b=pv.Mark.stack;if(a&&!this.root.scene){this.root.render();return}var c=[];for(var d=this;d.parent;d=d.parent)c.unshift(d.childIndex);this.bind();while(a&&!a.hasOwnProperty("index"))a=a.parent;this.context(a?a.scene:undefined,a?a.index:-1,function(){e(this.root,0,1)})},pv.Mark.stack=[],pv.Mark.prototype.bind=function(){function e(e){do{var f=e.$properties;for(var g=f.length-1;g>=0;g--){var h=f[g];if(!(h.name in a)){a[h.name]=h;switch(h.name){case"data":c=h;break;case"visible":case"id":d.push(h);break;default:b[h.type].push(h)}}}}while(e=e.proto)}var a={},b=[[],[],[],[]],c,d=[];e(this),e(this.defaults),b[1].reverse(),b[3].reverse();var f=this;do for(var g in f.properties)g in a||b[2].push(a[g]={name:g,type:2,value:null});while(f=f.proto);var h=b[0].concat(b[1]);for(var i=0;i<h.length;i++)this.propertyMethod(h[i].name,!0);this.binds={properties:a,data:c,defs:h,required:d,optional:pv.blend(b)}},pv.Mark.prototype.build=function(){var a=this.scene,b=pv.Mark.stack;a||(a=this.scene=[],a.mark=this,a.type=this.type,a.childIndex=this.childIndex,this.parent&&(a.parent=this.parent.scene,a.parentIndex=this.parent.index)),this.target&&(a.target=this.target.instances(a));if(this.binds.defs.length){var c=a.defs;c||(a.defs=c={});for(var d=0;d<this.binds.defs.length;d++){var e=this.binds.defs[d],f=c[e.name];if(!f||e.id>f.id)c[e.name]={id:0,value:e.type&1?e.value.apply(this,b):e.value}}}var g=this.binds.data;g=g.type&1?g.value.apply(this,b):g.value,b.unshift(null),a.length=g.length;for(var d=0;d<g.length;d++){pv.Mark.prototype.index=this.index=d;var h=a[d];h||(a[d]=h={}),h.data=b[0]=g[d],this.buildInstance(h)}return pv.Mark.prototype.index=-1,delete this.index,b.shift(),this},pv.Mark.prototype.buildProperties=function(a,b){for(var c=0,d=b.length;c<d;c++){var e=b[c],f=e.value;switch(e.type){case 0:case 1:f=this.scene.defs[e.name].value;break;case 3:f=f.apply(this,pv.Mark.stack)}a[e.name]=f}},pv.Mark.prototype.buildInstance=function(a){this.buildProperties(a,this.binds.required),a.visible&&(this.buildProperties(a,this.binds.optional),this.buildImplied(a))},pv.Mark.prototype.buildImplied=function(a){var b=a.left,c=a.right,d=a.top,e=a.bottom,f=this.properties,g=f.width?a.width:0,h=f.height?a.height:0,i=this.parent?this.parent.width():g+b+c;g==null?g=i-(c=c||0)-(b=b||0):c==null?b==null?b=c=(i-g)/2:c=i-g-b:b==null&&(b=i-g-c);var j=this.parent?this.parent.height():h+d+e;h==null?h=j-(d=d||0)-(e=e||0):e==null?d==null?e=d=(j-h)/2:e=j-h-d:d==null&&(d=j-h-e),a.left=b,a.right=c,a.top=d,a.bottom=e,f.width&&(a.width=g),f.height&&(a.height=h),f.textStyle&&!a.textStyle&&(a.textStyle=pv.Color.transparent),f.fillStyle&&!a.fillStyle&&(a.fillStyle=pv.Color.transparent),f.strokeStyle&&!a.strokeStyle&&(a.strokeStyle=pv.Color.transparent)},pv.Mark.prototype.mouse=function(){var a=pv.event.pageX||0,b=pv.event.pageY||0,c=this.root.canvas();do a-=c.offsetLeft,b-=c.offsetTop;while(c=c.offsetParent);var d=pv.Transform.identity,e=this.properties.transform?this:this.parent,f=[];do f.push(e);while(e=e.parent);while(e=f.pop())d=d.translate(e.left(),e.top()).times(e.transform());return d=d.invert(),pv.vector(a*d.k+d.x,b*d.k+d.y)},pv.Mark.prototype.event=function(a,b){return this.$handlers[a]=pv.functor(b),this},pv.Mark.prototype.context=function(a,b,c){function h(a,b){pv.Mark.scene=a,d.index=b;if(!a)return;var c=a.mark,f=c,g=[];do g.push(f),e.push(a[b].data),f.index=b,f.scene=a,b=a.parentIndex,a=a.parent;while(f=f.parent);for(var h=g.length-1,i=1;h>0;h--)f=g[h],f.scale=i,i*=f.scene[f.index].transform
.k;if(c.children)for(var h=0,j=c.children.length;h<j;h++)f=c.children[h],f.scene=c.scene[c.index].children[h],f.scale=i}function i(a,b){if(!a)return;var c=a.mark,d;if(c.children)for(var f=0,g=c.children.length;f<g;f++)d=c.children[f],delete d.scene,delete d.scale;d=c;do e.pop(),d.parent&&(delete d.scene,delete d.scale),delete d.index;while(d=d.parent)}var d=pv.Mark.prototype,e=pv.Mark.stack,f=pv.Mark.scene,g=d.index;i(f,g),h(a,b);try{c.apply(this,e)}finally{i(a,b),h(f,g)}},pv.Mark.dispatch=function(a,b,c){var d=b.mark,e=b.parent,f=d.$handlers[a];return f?(d.context(b,c,function(){d=f.apply(d,pv.Mark.stack),d&&d.render&&d.render()}),!0):e&&pv.Mark.dispatch(a,e,b.parentIndex)},pv.Mark.prototype.transition=function(){return new pv.Transition(this)},pv.Mark.prototype.on=function(a){return this["$"+a]=new pv.Transient(this)},pv.Anchor=function(a){pv.Mark.call(this),this.target=a,this.parent=a.parent},pv.Anchor.prototype=pv.extend(pv.Mark).property("name",String),pv.Anchor.prototype.extend=function(a){return this.proto=a,this},pv.Area=function(){pv.Mark.call(this)},pv.Area.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.color).property("fillStyle",pv.color).property("segmented",Boolean).property("interpolate",String).property("lineDash",String).property("tension",Number),pv.Area.prototype.type="area",pv.Area.prototype.defaults=(new pv.Area).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).interpolate("linear").tension(.7),pv.Area.prototype.buildImplied=function(a){a.height==null&&(a.height=0),a.width==null&&(a.width=0)},pv.Area.fixed={lineWidth:1,lineJoin:1,lineDash:1,strokeStyle:1,fillStyle:1,segmented:1,interpolate:1,tension:1,title:1,cursor:1,antialias:1,events:1,eccentricity:1},pv.Area.prototype.bind=function(){pv.Mark.prototype.bind.call(this);var a=this.binds,b=a.required,c=a.optional;for(var d=0,e=c.length;d<e;d++){var f=c[d];f.fixed=f.name in pv.Area.fixed,f.name=="segmented"&&(b.push(f),c.splice(d,1),d--,e--)}this.binds.$required=b,this.binds.$optional=c},pv.Area.prototype.build=function(){var a=this.scene,b=pv.Mark.stack;a||(a=this.scene=[],a.mark=this,a.type=this.type,a.childIndex=this.childIndex,this.parent&&(a.parent=this.parent.scene,a.parentIndex=this.parent.index)),this.target&&(a.target=this.target.instances(a));if(this.binds.defs.length){var c=a.defs;c||(a.defs=c={});for(var d=0;d<this.binds.defs.length;d++){var e=this.binds.defs[d],f=c[e.name];if(!f||e.id>f.id)c[e.name]={id:0,value:e.type&1?e.value.apply(this,b):e.value}}}var g=this.binds,h=pv.Mark.prototype,i=g.data;i=i.type&1?i.value.apply(this,b):i.value,b.unshift(null),a.length=i.length;if(i.length){var j=a[0];j||(a[0]=j={}),j.data=b[0]=i[0],h.index=this.index=0,g.required=g.$required,g.optional=g.$optional,h.buildInstance.call(this,j);var k={},l=function(a){return a.fixed&&(k[a.name]=j[a.name]),!a.fixed||!1};g.required=g.required.filter(l),j.segmented||(g.optional=g.optional.filter(l));var m=Object.create;if(!m){var n=function(){};n.prototype=k}for(var d=1;d<i.length;d++){h.index=this.index=d;var j=a[d];j||(a[d]=j=m?m(k):new n),j.data=b[0]=i[d],h.buildInstance.call(this,j)}h.index=-1,delete this.index,b.shift()}var o=pv.Color.transparent,e=this.properties,p=this.parent,q=p?p.width():null,r=p?p.height():null,s=!!this.properties.width,t=!!this.properties.height;for(var u=0,v=a.length;u<v;u++){var j=a[u],w=j.left,x=j.right,y=j.top,z=j.bottom,A=s?j.width:0,B=t?j.height:0,C=p?q:A+w+x;A==null?A=C-(j.right=x||0)-(j.left=w||0):x==null?w==null?j.left=j.right=(C-A)/2:j.right=C-A-w:w==null&&(j.left=C-A-x);var D=p?r:B+y+z;B==null?B=D-(j.top=y||0)-(j.bottom=z||0):z==null?y==null?j.bottom=j.top=(D-B)/2:j.bottom=D-B-y:y==null&&(j.top=D-B-z),s&&(j.width=A),t&&(j.height=B),j.fillStyle||(j.fillStyle=o),j.strokeStyle||(j.strokeStyle=o)}return this},pv.Area.prototype.anchor=function(a){var b;return pv.Mark.prototype.anchor.call(this,a).interpolate(function(){return this.scene.target[this.index].interpolate}).eccentricity(function(){return this.scene.target[this.index].eccentricity}).tension(function(){return this.scene.target[this.index].tension})},pv.Bar=function(){pv.Mark.call(this)},pv.Bar.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineDash",String).property("lineWidth",Number).property("strokeStyle",pv.color).property("fillStyle",pv.color),pv.Bar.prototype.type="bar",pv.Bar.prototype.defaults=(new pv.Bar).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)),pv.Dot=function(){pv.Mark.call(this)},pv.Dot.prototype=pv.extend(pv.Mark).property("size",Number).property("radius",Number).property("shape",String).property("angle",Number).property("lineWidth",Number).property("lineDash",String).property("strokeStyle",pv.color).property("fillStyle",pv.color),pv.Dot.prototype.type="dot",pv.Dot.prototype.defaults=(new pv.Dot).extend(pv.Mark.prototype.defaults).size(20).shape("circle").lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)),pv.Dot.prototype.anchor=function(a){var b;return pv.Mark.prototype.anchor.call(this,a).left(function(){var a=this.scene.target[this.index];switch(this.name()){case"bottom":case"top":case"center":return a.left;case"left":return null}return a.left+a.radius}).right(function(){var a=this.scene.target[this.index];return this.name()=="left"?a.right+a.radius:null}).top(function(){var a=this.scene.target[this.index];switch(this.name()){case"left":case"right":case"center":return a.top;case"top":return null}return a.top+a.radius}).bottom(function(){var a=this.scene.target[this.index];return this.name()=="top"?a.bottom+a.radius:null}).textAlign(function(){switch(this.name()){case"left":return"right";case"bottom":case"top":case"center":return"center"}return"left"}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"bottom":return"top"}return"bottom"})},pv.Dot.prototype.buildImplied=function(a){a.radius==null?a.radius=Math.sqrt(a.size):a.size==null&&(a.size=a.radius*a.radius),pv.Mark.prototype.buildImplied.call(this,a)},pv.Label=function(){pv.Mark.call(this)},pv.Label.prototype=pv.extend(pv.Mark).property("text",String).property("font",String).property("textAngle",Number).property("textStyle",pv.color).property("textAlign",String).property("textBaseline",String).property("textMargin",Number).property("textDecoration",String).property("textShadow",String),pv.Label.prototype.type="label",pv.Label.prototype.defaults=(new pv.Label).extend(pv.Mark.prototype.defaults).events("none").text(pv.identity).font("10px sans-serif").textAngle(0).textStyle("black").textAlign("left").textBaseline("bottom").textMargin(3),pv.Line=function(){pv.Mark.call(this)},pv.Line.prototype=pv.extend(pv.Mark).property("lineWidth",Number).property("lineJoin",String).property("lineDash",String).property("strokeStyle",pv.color).property("fillStyle",pv.color).property("segmented",Boolean).property("interpolate",String).property("eccentricity",Number).property("tension",Number),pv.Line.prototype.type="line",pv.Line.prototype.defaults=(new pv.Line).extend(pv.Mark.prototype.defaults).lineJoin("miter").lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).interpolate("linear").eccentricity(0).tension(.7),pv.Line.prototype.bind=pv.Area.prototype.bind,pv.Line.prototype.build=pv.Area.prototype.build,pv.Line.prototype.buildImplied=Boolean,pv.Line.prototype.anchor=function(a){return pv.Area.prototype.anchor.call(this,a).textAlign(function(a){switch(this.name()){case"left":return"right";case"bottom":case"top":case"center":return"center";case"right":return"left"}}).textBaseline(function(a){switch(this.name()){case"right":case"left":case"center":return"middle";case"top":return"bottom";case"bottom":return"top"}})},pv.Rule=function(){pv.Mark.call(this)},pv.Rule.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineDash",String).property("lineWidth",Number).property("strokeStyle",pv.color),pv.Rule.prototype.type="rule",pv.Rule.prototype.defaults=(new pv.Rule).extend(pv.Mark.prototype.defaults).lineWidth(1).strokeStyle("black").antialias(!1),pv.Rule.prototype.anchor=pv.Line.prototype.anchor,pv.Rule.prototype.buildImplied=function(a){var b=a.left,c=a.right,d=a.top,e=a.bottom;a.width!=null||b==null&&c==null||c!=null&&b!=null?a.height=0:a.width=0,pv.Mark.prototype.buildImplied.call(this,a)},pv.Panel=function(){pv.Bar.call(this),this.children=[],this.root=this,this.$dom=pv.$&&pv.$.s},pv.Panel.prototype=pv.extend(pv.Bar).property("transform").property("overflow",String).property("canvas",function(a){return typeof a=="string"?document.getElementById(a):a}),pv.Panel.prototype.type="panel",pv.Panel.prototype.defaults=(new pv.Panel).extend(pv.Bar.prototype.defaults).fillStyle(null).overflow("visible"),pv.Panel.prototype.anchor=function(a){var b=pv.Bar.prototype.anchor.call(this,a);return b.parent=this,b},pv.Panel.prototype.add=function(a){var b=new a;return b.parent=this,b.root=this.root,b.childIndex=this.children.length,this.children.push(b),b},pv.Panel.prototype.bind=function(){pv.Mark.prototype.bind.call(this);for(var a=0;a<this.children.length;a++)this.children[a].bind()},pv.Panel.prototype.buildInstance=function(a){pv.Bar.prototype.buildInstance.call(this,a);if(!a.visible)return;a.children||(a.children=[]);var b=this.scale*a.transform.k,c,d=this.children.length;pv.Mark.prototype.index=-1;for(var e=0;e<d;e++)c=this.children[e],c.scene=a.children[e],c.scale=b,c.build();for(var e=0;e<d;e++)c=this.children[e],a.children[e]=c.scene,delete c.scene,delete c.scale;a.children.length=d},pv.Panel.prototype.buildImplied=function(a){if(!this.parent){var b=a.canvas;if(b){if(b.$panel!=this){b.$panel=this;while(b.lastChild)b.removeChild(b.lastChild)}var c,d;a.width==null&&(c=parseFloat(pv.css(b,"width")),a.width=c-a.left-a.right),a.height==null&&(d=parseFloat(pv.css(b,"height")),a.height=d-a.top-a.bottom)}else{var e=this.$canvas||(this.$canvas=[]);if(!(b=e[this.index])){b=e[this.index]=document.createElement("span");if(this.$dom)this.$dom.parentNode.insertBefore(b,this.$dom);else{var f=document.body;while(f.lastChild&&f.lastChild.tagName)f=f.lastChild;f!=document.body&&(f=f.parentNode),f.appendChild(b)}}}a.canvas=b}a.transform||(a.transform=pv.Transform.identity),pv.Mark.prototype.buildImplied.call(this,a)},pv.Image=function(){pv.Bar.call(this)},pv.Image.prototype=pv.extend(pv.Bar).property("url",String).property("imageWidth",Number).property("imageHeight",Number),pv.Image.prototype.type="image",pv.Image.prototype.defaults=(new pv.Image).extend(pv.Bar.prototype.defaults).fillStyle(null),pv.Image.prototype.image=function(a){return this.$image=function(){var b=a.apply(this,arguments);return b==null?pv.Color.transparent:typeof b=="string"?pv.color(b):b},this},pv.Image.prototype.bind=function(){pv.Bar.prototype.bind.call(this);var a=this.binds,b=this;do a.image=b.$image;while(!a.image&&(b=b.proto))},pv.Image.prototype.buildImplied=function(a){pv.Bar.prototype.buildImplied.call(this,a);if(!a.visible)return;a.imageWidth==null&&(a.imageWidth=a.width),a.imageHeight==null&&(a.imageHeight=a.height);if(a.url==null&&this.binds.image){var b=this.$canvas||(this.$canvas=document.createElement("canvas")),c=b.getContext("2d"),d=a.imageWidth,e=a.imageHeight,f=pv.Mark.stack,g;b.width=d,b.height=e,g=(a.image=c.createImageData(d,e)).data,f.unshift(null,null);for(var h=0,i=0;h<e;h++){f[1]=h;for(var j=0;j<d;j++){f[0]=j;var k=this.binds.image.apply(this,f);g[i++]=k.r,g[i++]=k.g,g[i++]=k.b,g[i++]=255*k.a}}f.splice(0,2)}},pv.Wedge=function(){pv.Mark.call(this)},pv.Wedge.prototype=pv.extend(pv.Mark).property("startAngle",Number).property("endAngle",Number).property("angle",Number).property("innerRadius",Number).property("outerRadius",Number).property("lineWidth",Number).property("lineDash",String).property("strokeStyle",pv.color).property("fillStyle",pv.color),pv.Wedge.prototype.type="wedge",pv.Wedge.prototype.defaults=(new pv.Wedge).extend(pv.Mark.prototype.defaults).startAngle(function(){var a=this.sibling();return a?a.endAngle:-Math.PI/2}).innerRadius(0).lineWidth(1.5).strokeStyle(null).fillStyle(pv.Colors.category20().by(pv.index)),pv.Wedge.prototype.midRadius=function(){return(this.innerRadius()+this.outerRadius())/2},pv.Wedge.prototype.midAngle=function(){return(this.startAngle()+this.endAngle())/2},pv.Wedge.prototype.anchor=function(a){function b(a){return a.innerRadius||a.angle<2*Math.PI}function c(a){return(a.innerRadius+a.outerRadius)/2}function d(a){return(a.startAngle+a.endAngle)/2}return pv.Mark.prototype.anchor.call(this,a).left(function(){var a=this.scene.target[this.index];if(b(a))switch(this.name()){case"outer":return a.left+a.outerRadius*Math.cos(d(a));case"inner":return a.left+a.innerRadius*Math.cos(d(a));case"start":return a.left+c(a)*Math.cos(a.startAngle);case"center":return a.left+c(a)*Math.cos(d(a));case"end":return a.left+c(a)*Math.cos(a.endAngle)}return a.left}).top(function(){var a=this.scene.target[this.index];if(b(a))switch(this.name()){case"outer":return a.top+a.outerRadius*Math.sin(d(a));case"inner":return a.top+a.innerRadius*Math.sin(d(a));case"start":return a.top+c(a)*Math.sin(a.startAngle);case"center":return a.top+c(a)*Math.sin(d(a));case"end":return a.top+c(a)*Math.sin(a.endAngle)}return a.top}).textAlign(function(){var a=this.scene.target[this.index];if(b(a))switch(this.name()){case"outer":return pv.Wedge.upright(d(a))?"right":"left";case"inner":return pv.Wedge.upright(d(a))?"left":"right"}return"center"}).textBaseline(function(){var a=this.scene.target[this.index];if(b(a))switch(this.name()){case"start":return pv.Wedge.upright(a.startAngle)?"top":"bottom";case"end":return pv.Wedge.upright(a.endAngle)?"bottom":"top"}return"middle"}).textAngle(function(){var a=this.scene.target[this.index],c=0;if(b(a))switch(this.name()){case"center":case"inner":case"outer":c=d(a);break;case"start":c=a.startAngle;break;case"end":c=a.endAngle}return pv.Wedge.upright(c)?c:c+Math.PI})},pv.Wedge.upright=function(a){return a=a%(2*Math.PI),a=a<0?2*Math.PI+a:a,a<Math.PI/2||a>=3*Math.PI/2},pv.Wedge.prototype.buildImplied=function(a){a.angle==null?a.angle=a.endAngle-a.startAngle:a.endAngle==null&&(a.endAngle=a.startAngle+a.angle),pv.Mark.prototype.buildImplied.call(this,a)},pv.Ease=function(){function a(a){return function(b){return 1-a(1-b)}}function b(a){return function(b){return.5*(b<.5?a(2*b):2-a(2-2*b))}}function c(a){return function(b){return b<0?0:b>1?1:Math.pow(b,a)}}function d(a){return 1-Math.cos(a*Math.PI/2)}function e(a){return a?Math.pow(2,10*(a-1))-.001:0}function f(a){return-(Math.sqrt(1-a*a)-1)}function g(a,b){var c;return b||(b=.45),!a||a<1?(a=1,c=b/4):c=b/(2*Math.PI)*Math.asin(1/a),function(d){return d<=0||d>=1?d:-(a*Math.pow(2,10*--d)*Math.sin((d-c)*2*Math.PI/b))}}function h(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function i(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}var j=c(2),k=c(3),l=g(),m=h(),n={linear:pv.identity,"quad-in":j,"quad-out":a(j),"quad-in-out":b(j),"quad-out-in":b(a(j)),"cubic-in":k,"cubic-out":a(k),"cubic-in-out":b(k),"cubic-out-in":b(a(k)),"sin-in":d,"sin-out":a(d),"sin-in-out":b(d),"sin-out-in":b(a(d)),"exp-in":e,"exp-out":a(e),"exp-in-out":b(e),"exp-out-in":b(a(e)),"circle-in":f,"circle-out":a(f),"circle-in-out":b(f),"circle-out-in":b(a(f)),"elastic-in":l,"elastic-out":a(l),"elastic-in-out":b(l),"elastic-out-in":b(a(l)),"back-in":m,"back-out":a(m),"back-in-out":b(m),"back-out-in":b(a(m)),"bounce-in":i,"bounce-out":a(i),"bounce-in-out":b(i),"bounce-out-in":b(a(i))};return pv.ease=function(a){return n[a]},{reverse:a,reflect:b,linear:function(){return pv.identity},sin:function(){return d},exp:function(){return e},circle:function(){return f},elastic:g,back:h,bounce:i,poly:c}}(),pv.Transition=function(a){function i(a){var b={};for(var c=0;c<a.length;c++){var d=a[c];d.id&&(b[d.id]=d)}return b}function j(a,b,c,d){if(b in f)var e=pv.Scale.interpolator(c[b],d[b]),g=function(a){c[b]=e(a)};else var g=function(a){a>.5&&(c[b]=d[b])};g.next=a.head,a.head=g}function k(a,b,c){for(var d in b){if(d=="children")continue;if(b[d]==c[d])continue;j(a,d,b,c)}if(b.children)for(var e=0;e<b.children.length;e++)l(a,b.children[e],c.children[e])}function l(a,b,c){var d=b.mark,e=i(b),f=i(c);for(var g=0;g<b.length;g++){var h=b[g],j=h.id?f[h.id]:c[g];h.index=g;if(!h.visible)continue;if(!j||!j.visible){var l=m(b,g,d.$exit,c);h.transition=j?2:(c.push(l),1),j=l}k(a,h,j)}for(var g=0;g<c.length;g++){var j=c[g],h=j.id?e[j.id]:b[g];if((!h||!h.visible)&&j.visible){var l=m(c,g,d.$enter,b);h?b[h.index]=l:b.push(l),k(a,l,j)}}}function m(a,b,c,d){var e=pv.extend(a[b]),f=a.mark,h=f.root.scene,i=(c||g).$properties,j;d.target&&(j=d.target[d.length])&&(a=pv.extend(a),a.target=pv.extend(d.target),a.target[b]=j);var k={};for(var l=0;l<i.length;l++)k[i[l].name]=1;return i=f.binds.optional.filter(function(a){return!(a.name in k)}).concat(i),f.context(a,b,function(){this.buildProperties(e,i),this.buildImplied(e)}),f.root.scene=h,e}function n(a){for(var b=0,c=0;b<a.length;b++){var d=a[b];d.transition!=1&&(a[c++]=d,d.transition==2&&(d.visible=!1),d.children&&d.children.forEach(n))}a.length=c}var b=this,c=pv.ease("cubic-in-out"),d=250,e,f={top:1,left:1,right:1,bottom:1,width:1,height:1,innerRadius:1,outerRadius:1,radius:1,startAngle:1,endAngle:1,angle:1,fillStyle:1,strokeStyle:1,lineWidth:1,eccentricity:1,tension:1,textAngle:1,textStyle:1,textMargin:1},g=new pv.Transient,h=pv.Color.transparent;b.ease=function(a){return arguments.length?(c=typeof a=="function"?a:pv.ease(a),b):c},b.duration=function(a){return arguments.length?(d=Number(a),b):d},b.start=function(){a.parent&&fail(),a.$transition&&a.$transition.stop(),a.$transition=b;var f=pv.Mark.prototype.index,g=a.scene,h;a.scene=null,a.bind(),a.build(),h=a.scene,a.scene=g,h.$g=g.$g,pv.Mark.prototype.index=f;var i=Date.now(),j={};l(j,g,h),e=setInterval(function(){var e=Math.max(0,Math.min(1,(Date.now()-i)/d)),f=c(e);for(var h=j.head;h;h=h.next)h(f);e==1&&(n(a.scene),b.stop()),pv.Scene.updateAll(g)},24)},b.stop=function(){clearInterval(e)}},pv.Transient=function(a){pv.Mark.call(this),this.fillStyle(null).strokeStyle(null).textStyle(null),this.on=function(b){return a.on(b)}},pv.Transient.prototype=pv.extend(pv.Mark),pv.Behavior={},pv.Behavior.drag=function(){function f(f){b=this.index,a=this.scene;var g=this.mouse();d=((c=f).fix=pv.vector(f.x,f.y)).minus(g),e={x:this.parent.width()-(f.dx||0),y:this.parent.height()-(f.dy||0)},a.mark.context(a,b,function(){this.render()}),pv.Mark.dispatch("dragstart",a,b)}function g(){if(!a)return;a.mark.context(a,b,function(){var a=this.mouse();c.x=c.fix.x=Math.max(0,Math.min(d.x+a.x,e.x)),c.y=c.fix.y=Math.max(0,Math.min(d.y+a.y,e.y)),this.render()}),pv.Mark.dispatch("drag",a,b)}function h(){if(!a)return;c.fix=null,a.mark.context(a,b,function(){this.render()}),pv.Mark.dispatch("dragend",a,b),a=null}var a,b,c,d,e;return pv.listen(window,"mousemove",g),pv.listen(window,"mouseup",h),f},pv.Behavior.point=function(a){function g(a,b){var c=a[b],f={cost:Infinity};for(var h=0,i=c.visible&&c.children.length;h<i;h++){var j=c.children[h],k=j.mark,l;if(k.type=="panel"){k.scene=j;for(var m=0,n=j.length;m<n;m++)k.index=m,l=g(j,m),l.cost<f.cost&&(f=l);delete k.scene,delete k.index}else if(k.$handlers.point){var o=k.mouse();for(var m=0,n=j.length;m<n;m++){var p=j[m],q=o.x-p.left-(p.width||0)/2,r=o.y-p.top-(p.height||0)/2,s=d*q*q+e*r*r;s<f.cost&&(f.distance=q*q+r*r,f.cost=s,f.scene=j,f.index=m)}}}return f}function h(){var a=g(this.scene,this.index);if(a.cost==Infinity||a.distance>f)a=null;if(b){if(a&&b.scene==a.scene&&b.index==a.index)return;pv.Mark.dispatch("unpoint",b.scene,b.index)}if(b=a)pv.Mark.dispatch("point",a.scene,a.index),pv.listen(this.root.canvas(),"mouseout",i)}function i(a){b&&!pv.ancestor(this,a.relatedTarget)&&(pv.Mark.dispatch("unpoint",b.scene,b.index),b=null)}var b,c=null,d=1,e=1,f=arguments.length?a*a:900;return h.collapse=function(a){if(arguments.length){c=String(a);switch(c){case"y":d=1,e=0;break;case"x":d=0,e=1;break;default:d=1,e=1}return h}return c},h},pv.Behavior.select=function(){function e(e){b=this.index,a=this.scene,d=this.mouse(),c=e,c.x=d.x,c.y=d.y,c.dx=c.dy=0,pv.Mark.dispatch("selectstart",a,b)}function f(){if(!a)return;a.mark.context(a,b,function(){var a=this.mouse();c.x=Math.max(0,Math.min(d.x,a.x)),c.y=Math.max(0,Math.min(d.y,a.y)),c.dx=Math.min(this.width(),Math.max(a.x,d.x))-c.x,c.dy=Math.min(this.height(),Math.max(a.y,d.y))-c.y,this.render()}),pv.Mark.dispatch("select",a,b)}function g(){if(!a)return;pv.Mark.dispatch("selectend",a,b),a=null}var a,b,c,d;return pv.listen(window,"mousemove",f),pv.listen(window,"mouseup",g),e},pv.Behavior.resize=function(a){function f(f){c=this.index,b=this.scene,e=this.mouse(),d=f;switch(a){case"left":e.x=d.x+d.dx;break;case"right":e.x=d.x;break;case"top":e.y=d.y+d.dy;break;case"bottom":e.y=d.y}pv.Mark.dispatch("resizestart",b,c)}function g(){if(!b)return;b.mark.context(b,c,function(){var a=this.mouse();d.x=Math.max(0,Math.min(e.x,a.x)),d.y=Math.max(0,Math.min(e.y,a.y)),d.dx=Math.min(this.parent.width(),Math.max(a.x,e.x))-d.x,d.dy=Math.min(this.parent.height(),Math.max(a.y,e.y))-d.y,this.render()}),pv.Mark.dispatch("resize",b,c)}function h(){if(!b)return;pv.Mark.dispatch("resizeend",b,c),b=null}var b,c,d,e;return pv.listen(window,"mousemove",g),pv.listen(window,"mouseup",h),f},pv.Behavior.pan=function(){function g(){b=this.index,a=this.scene,d=pv.vector(pv.event.pageX,pv.event.pageY),c=this.transform(),e=1/(c.k*this.scale),f&&(f={x:(1-c.k)*this.width(),y:(1-c.k)*this.height()})}function h(){if(!a)return;a.mark.context(a,b,function(){var a=(pv.event.pageX-d.x)*e,b=(pv.event.pageY-d.y)*e,g=c.translate(a,b);f&&(g.x=Math.max(f.x,Math.min(0,g.x)),g.y=Math.max(f.y,Math.min(0,g.y))),this.transform(g).render()}),pv.Mark.dispatch("pan",a,b)}function i(){a=null}var a,b,c,d,e,f;return g.bound=function(a){return arguments.length?(f=Boolean(a),this):Boolean(f)},pv.listen(window,"mousemove",h),pv.listen(window,"mouseup",i),g},pv.Behavior.zoom=function(a){function c(){var c=this.mouse(),d=pv.event.wheel*a,e=this.transform().translate(c.x,c.y).scale(d<0?1e3/(1e3-d):(1e3+d)/1e3).translate(-c.x,-c.y);b&&(e.k=Math.max(1,e.k),e.x=Math.max((1-e.k)*this.width(),Math.min(0,e.x)),e.y=Math.max((1-e.k)*this.height(),Math.min(0,e.y))),this.transform(e).render(),pv.Mark.dispatch("zoom",this.scene,this.index)}var b;return arguments.length||(a=1/48),c.bound=function(a){return arguments.length?(b=Boolean(a),this):Boolean(b)},c}